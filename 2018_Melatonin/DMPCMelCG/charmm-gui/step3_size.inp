* GENERATED BY CHARMM-GUI (http://www.charmm-gui.org) v2.0 on Nov, 21. 2018. JOBID=1542785260
* DETERMINE THE SYSTEM SIZE IN XY 
* 

DIMENS CHSIZE 3000000 MAXRES 3000000

! Read martini topology and parameter files
stream martini_toppar.str

set toparea = 0
set botarea = 0
set protZmax = 0
set protZmin = 0
set BOXTYPE = rect
set Alpha = 90.0
set Beta  = 90.0
set Gamma = 90.0

set liptoparea = 35099.2
set lipbotarea = 35099.2
set nliptop    = 569
set nlipbot    = 569

calc LXYtop = sqrt( @liptoparea + @toparea )
calc LXYbot = sqrt( @lipbotarea + @botarea )
calc LXY    = ( @LXYtop + @LXYbot ) / 2

! allow 5% difference along X and Y
calc XvsY = 1
if XvsY .lt. 1.05 if XvsY .gt. 0.95 calc XvsY = 1
calc B = sqrt( @LXY * @LXY / @XvsY )
calc A = @XvsY * @B

set XTLtype = ORTHorhombic
if A .eq. @B set XTLtype = TETRagonal

! Z value determination
calc lipboxZhalf = 17

if protZmax .lt.  @lipboxZhalf set protZmax =  @lipboxZhalf
if protZmin .gt. -@lipboxZhalf set protZmin = -@lipboxZhalf

! water layer from protein top and bottom
calc wboxZ = 22.5

calc propzup = @protZmax + @wboxZ
calc propzdn = @protZmin - @wboxZ

calc watZup = 0
calc watZdn = 0
if propzup .ge.  @lipboxZhalf calc watZup =   @propzup - @lipboxZhalf
if propzdn .lt. -@lipboxZhalf calc watZdn = - @propzdn - @lipboxZhalf

calc boxsizeZ = @lipboxZhalf * 2 + @watZup + @watZdn
calc zcen = ( @watZup - @watZdn ) / 2.0

calc watboxZ = @watZup
if watZup .lt. @watZdn calc watboxZ = @watZdn

stream step3_nlipids_upper.prm
stream step3_nlipids_lower.prm

calc ncharge = 0 
calc ncharge = @ncharge + -1 * ( @nchoatop + @nchoabot ) 
calc ncharge = @ncharge + -2 * ( @ndapatop + @ndapabot ) 
calc ncharge = @ncharge + -2 * ( @ndbpatop + @ndbpabot ) 
calc ncharge = @ncharge + -2 * ( @ndfpatop + @ndfpabot ) 
calc ncharge = @ncharge + -2 * ( @ndgpatop + @ndgpabot ) 
calc ncharge = @ncharge + -2 * ( @ndipatop + @ndipabot ) 
calc ncharge = @ncharge + -2 * ( @ndlpatop + @ndlpabot ) 
calc ncharge = @ncharge + -2 * ( @ndnpatop + @ndnpabot ) 
calc ncharge = @ncharge + -2 * ( @ndopatop + @ndopabot ) 
calc ncharge = @ncharge + -2 * ( @ndppatop + @ndppabot ) 
calc ncharge = @ncharge + -2 * ( @ndrpatop + @ndrpabot ) 
calc ncharge = @ncharge + -2 * ( @ndtpatop + @ndtpabot ) 
calc ncharge = @ncharge + -2 * ( @ndvpatop + @ndvpabot ) 
calc ncharge = @ncharge + -2 * ( @ndxpatop + @ndxpabot ) 
calc ncharge = @ncharge + -2 * ( @ndypatop + @ndypabot ) 
calc ncharge = @ncharge + -2 * ( @nlppatop + @nlppabot ) 
calc ncharge = @ncharge + -2 * ( @npapatop + @npapabot ) 
calc ncharge = @ncharge + -2 * ( @npgpatop + @npgpabot ) 
calc ncharge = @ncharge + -2 * ( @npipatop + @npipabot ) 
calc ncharge = @ncharge + -2 * ( @npopatop + @npopabot ) 
calc ncharge = @ncharge + -2 * ( @nprpatop + @nprpabot ) 
calc ncharge = @ncharge + -2 * ( @npupatop + @npupabot ) 
calc ncharge = @ncharge + -1 * ( @ndapgtop + @ndapgbot ) 
calc ncharge = @ncharge + -1 * ( @ndbpgtop + @ndbpgbot ) 
calc ncharge = @ncharge + -1 * ( @ndfpgtop + @ndfpgbot ) 
calc ncharge = @ncharge + -1 * ( @ndgpgtop + @ndgpgbot ) 
calc ncharge = @ncharge + -1 * ( @ndipgtop + @ndipgbot ) 
calc ncharge = @ncharge + -1 * ( @ndlpgtop + @ndlpgbot ) 
calc ncharge = @ncharge + -1 * ( @ndnpgtop + @ndnpgbot ) 
calc ncharge = @ncharge + -1 * ( @ndopgtop + @ndopgbot ) 
calc ncharge = @ncharge + -1 * ( @ndppgtop + @ndppgbot ) 
calc ncharge = @ncharge + -1 * ( @ndrpgtop + @ndrpgbot ) 
calc ncharge = @ncharge + -1 * ( @ndtpgtop + @ndtpgbot ) 
calc ncharge = @ncharge + -1 * ( @ndvpgtop + @ndvpgbot ) 
calc ncharge = @ncharge + -1 * ( @ndxpgtop + @ndxpgbot ) 
calc ncharge = @ncharge + -1 * ( @ndypgtop + @ndypgbot ) 
calc ncharge = @ncharge + -1 * ( @njfpgtop + @njfpgbot ) 
calc ncharge = @ncharge + -1 * ( @njppgtop + @njppgbot ) 
calc ncharge = @ncharge + -1 * ( @nlppgtop + @nlppgbot ) 
calc ncharge = @ncharge + -1 * ( @noppgtop + @noppgbot ) 
calc ncharge = @ncharge + -1 * ( @npapgtop + @npapgbot ) 
calc ncharge = @ncharge + -1 * ( @npgpgtop + @npgpgbot ) 
calc ncharge = @ncharge + -1 * ( @npipgtop + @npipgbot ) 
calc ncharge = @ncharge + -1 * ( @npopgtop + @npopgbot ) 
calc ncharge = @ncharge + -1 * ( @nprpgtop + @nprpgbot ) 
calc ncharge = @ncharge + -1 * ( @ndapstop + @ndapsbot ) 
calc ncharge = @ncharge + -1 * ( @ndbpstop + @ndbpsbot ) 
calc ncharge = @ncharge + -1 * ( @ndfpstop + @ndfpsbot ) 
calc ncharge = @ncharge + -1 * ( @ndgpstop + @ndgpsbot ) 
calc ncharge = @ncharge + -1 * ( @ndipstop + @ndipsbot ) 
calc ncharge = @ncharge + -1 * ( @ndlpstop + @ndlpsbot ) 
calc ncharge = @ncharge + -1 * ( @ndnpstop + @ndnpsbot ) 
calc ncharge = @ncharge + -1 * ( @ndopstop + @ndopsbot ) 
calc ncharge = @ncharge + -1 * ( @ndppstop + @ndppsbot ) 
calc ncharge = @ncharge + -1 * ( @ndrpstop + @ndrpsbot ) 
calc ncharge = @ncharge + -1 * ( @ndtpstop + @ndtpsbot ) 
calc ncharge = @ncharge + -1 * ( @ndupstop + @ndupsbot ) 
calc ncharge = @ncharge + -1 * ( @ndvpstop + @ndvpsbot ) 
calc ncharge = @ncharge + -1 * ( @ndxpstop + @ndxpsbot ) 
calc ncharge = @ncharge + -1 * ( @ndypstop + @ndypsbot ) 
calc ncharge = @ncharge + -1 * ( @nlppstop + @nlppsbot ) 
calc ncharge = @ncharge + -1 * ( @npapstop + @npapsbot ) 
calc ncharge = @ncharge + -1 * ( @npgpstop + @npgpsbot ) 
calc ncharge = @ncharge + -1 * ( @npipstop + @npipsbot ) 
calc ncharge = @ncharge + -1 * ( @npopstop + @npopsbot ) 
calc ncharge = @ncharge + -1 * ( @npqpstop + @npqpsbot ) 
calc ncharge = @ncharge + -1 * ( @nprpstop + @nprpsbot ) 
calc ncharge = @ncharge + -1 * ( @npupstop + @npupsbot ) 
calc ncharge = @ncharge + -3 * ( @ndpp1top + @ndpp1bot ) 
calc ncharge = @ncharge + -5 * ( @ndpp2top + @ndpp2bot ) 
calc ncharge = @ncharge + -1 * ( @ndppitop + @ndppibot ) 
calc ncharge = @ncharge + -1 * ( @npapitop + @npapibot ) 
calc ncharge = @ncharge + -1 * ( @npipitop + @npipibot ) 
calc ncharge = @ncharge + -3 * ( @npop1top + @npop1bot ) 
calc ncharge = @ncharge + -5 * ( @npop2top + @npop2bot ) 
calc ncharge = @ncharge + -7 * ( @npop3top + @npop3bot ) 
calc ncharge = @ncharge + -1 * ( @npopitop + @npopibot ) 
calc ncharge = @ncharge + -1 * ( @npupitop + @npupibot ) 
calc ncharge = @ncharge + -3 * ( @npvp1top + @npvp1bot ) 
calc ncharge = @ncharge + -5 * ( @npvp2top + @npvp2bot ) 
calc ncharge = @ncharge + -7 * ( @npvp3top + @npvp3bot ) 
calc ncharge = @ncharge + -1 * ( @npvpitop + @npvpibot ) 
calc ncharge = @ncharge + -1 * ( @ncdl1top + @ncdl1bot ) 
calc ncharge = @ncharge + -2 * ( @ncdl2top + @ncdl2bot ) 
calc ncharge = @ncharge + -1 * ( @nacntop + @nacnbot ) 
calc ncharge = @ncharge + -1 * ( @nbcntop + @nbcnbot ) 
calc ncharge = @ncharge + -1 * ( @nlcntop + @nlcnbot ) 
calc ncharge = @ncharge + -1 * ( @npcntop + @npcnbot ) 
calc ncharge = @ncharge + -1 * ( @nucntop + @nucnbot ) 
calc ncharge = @ncharge + -1 * ( @nxcntop + @nxcnbot ) 
calc ncharge = @ncharge + -1 * ( @nsdstop + @nsdsbot ) 
calc ncharge = @ncharge + -1 * ( @ndbg1top + @ndbg1bot ) 
calc ncharge = @ncharge + -1 * ( @ndbg3top + @ndbg3bot ) 
calc ncharge = @ncharge + -1 * ( @ndpg1top + @ndpg1bot ) 
calc ncharge = @ncharge + -1 * ( @ndpg3top + @ndpg3bot ) 
calc ncharge = @ncharge + -1 * ( @ndpsgtop + @ndpsgbot ) 
calc ncharge = @ncharge + -1 * ( @ndxg1top + @ndxg1bot ) 
calc ncharge = @ncharge + -1 * ( @ndxg3top + @ndxg3bot ) 
calc ncharge = @ncharge + -1 * ( @nfpsgtop + @nfpsgbot ) 
calc ncharge = @ncharge + -1 * ( @nopsgtop + @nopsgbot ) 
calc ncharge = @ncharge + -1 * ( @npng1top + @npng1bot ) 
calc ncharge = @ncharge + -1 * ( @npng3top + @npng3bot ) 
calc ncharge = @ncharge + -1 * ( @nxng1top + @nxng1bot ) 
calc ncharge = @ncharge + -1 * ( @nxng3top + @nxng3bot ) 
calc ncharge = @ncharge + -10 * ( @nramptop + @nrampbot ) 
calc ncharge = @ncharge + -6 * ( @nremptop + @nrempbot ) 
calc ncharge = @ncharge + -10 * ( @noanttop + @noantbot )

open write card  unit 51 name step3_size.str
write title unit 51
* set BOXtype  = @BOXtype
* set XTLtype  = @XTLtype
* set A        = @A
* set B        = @B
* set C        = @boxsizez
* set Alpha    = @Alpha
* set Beta     = @Beta
* set Gamma    = @Gamma
* set Zcen     = @zcen
* set NLIPTOP  = @nliptop
* set NLIPBOT  = @nlipbot
* set wboxZ    = @wboxZ
* set watboxZ  = @watboxZ
* set ncharge  = @ncharge
*

stop