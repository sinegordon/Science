* GENERATED BY CHARMM-GUI (http://www.charmm-gui.org) v2.0 on Nov, 21. 2018. JOBID=1542785260
* GENERATES LIPID PACKING USING BIG SPHERES
* 

DIMENS CHSIZE 3000000 MAXRES 3000000

! Read martini topology and parameter files
stream martini_toppar.str

! Read the system information
stream step3_size.str
stream step3_nlipids_upper.prm
stream step3_nlipids_lower.prm

calc nprot = 0

! Read toppar for big-spheres (POL) 
stream step3_packing_pol.str

! Generate big-spheres (POL) for upper leaflet
read sequence POL @NLIPTOP
generate UPPO warn

! Generate big-spheres (POL) for lower leaflet
read sequence POL @NLIPBOT
generate DNPO warn

!
! find chemical types of POLF
!

read sequence POLF 1
generate POLF warn

scalar type stat sele segid POLF end
calc ipolf = int ( ?save )

delete atom sele segid POLF end

!
! find chemical types of POL2
!

read sequence POL2 1
generate POL2 warn

scalar type stat sele segid POL2 end
calc ipol2 = int ( ?save )

delete atom sele segid POL2 end

!
! find chemical types of POL4
!

read sequence POL4 1
generate POL4 warn

scalar type stat sele segid POL4 end
calc ipol4 = int ( ?save )

delete atom sele segid POL4 end

!
! Change resnames [upper leaflet]
!

calc cnt1 = 0
calc cnt2 = 0
calc nlpstop = 0

if nchoatop .gt. 0 then
   calc cnt1 = @cnt2 + 1
   calc cnt2 = @cnt1 + @nchoatop - 1
   rename resname CHOA select segid UPPO .and. resid @cnt1:@cnt2 end
endif
if ncholtop .gt. 0 then
   calc cnt1 = @cnt2 + 1
   calc cnt2 = @cnt1 + @ncholtop - 1
   rename resname CHOL select segid UPPO .and. resid @cnt1:@cnt2 end
endif
if nchyotop .gt. 0 then
   calc cnt1 = @cnt2 + 1
   calc cnt2 = @cnt1 + @nchyotop - 1
   rename resname CHYO select segid UPPO .and. resid @cnt1:@cnt2 end
endif
if nergotop .gt. 0 then
   calc cnt1 = @cnt2 + 1
   calc cnt2 = @cnt1 + @nergotop - 1
   rename resname ERGO select segid UPPO .and. resid @cnt1:@cnt2 end
endif
if nhbhttop .gt. 0 then
   calc cnt1 = @cnt2 + 1
   calc cnt2 = @cnt1 + @nhbhttop - 1
   rename resname HBHT select segid UPPO .and. resid @cnt1:@cnt2 end
endif
if nhdpttop .gt. 0 then
   calc cnt1 = @cnt2 + 1
   calc cnt2 = @cnt1 + @nhdpttop - 1
   rename resname HDPT select segid UPPO .and. resid @cnt1:@cnt2 end
endif
if nhhoptop .gt. 0 then
   calc cnt1 = @cnt2 + 1
   calc cnt2 = @cnt1 + @nhhoptop - 1
   rename resname HHOP select segid UPPO .and. resid @cnt1:@cnt2 end
endif
if nhoprtop .gt. 0 then
   calc cnt1 = @cnt2 + 1
   calc cnt2 = @cnt1 + @nhoprtop - 1
   rename resname HOPR select segid UPPO .and. resid @cnt1:@cnt2 end
endif
if ndapatop .gt. 0 then
   calc cnt1 = @cnt2 + 1
   calc cnt2 = @cnt1 + @ndapatop - 1
   rename resname DAPA select segid UPPO .and. resid @cnt1:@cnt2 end
endif
if ndbpatop .gt. 0 then
   calc cnt1 = @cnt2 + 1
   calc cnt2 = @cnt1 + @ndbpatop - 1
   rename resname DBPA select segid UPPO .and. resid @cnt1:@cnt2 end
endif
if ndfpatop .gt. 0 then
   calc cnt1 = @cnt2 + 1
   calc cnt2 = @cnt1 + @ndfpatop - 1
   rename resname DFPA select segid UPPO .and. resid @cnt1:@cnt2 end
endif
if ndgpatop .gt. 0 then
   calc cnt1 = @cnt2 + 1
   calc cnt2 = @cnt1 + @ndgpatop - 1
   rename resname DGPA select segid UPPO .and. resid @cnt1:@cnt2 end
endif
if ndipatop .gt. 0 then
   calc cnt1 = @cnt2 + 1
   calc cnt2 = @cnt1 + @ndipatop - 1
   rename resname DIPA select segid UPPO .and. resid @cnt1:@cnt2 end
endif
if ndlpatop .gt. 0 then
   calc cnt1 = @cnt2 + 1
   calc cnt2 = @cnt1 + @ndlpatop - 1
   rename resname DLPA select segid UPPO .and. resid @cnt1:@cnt2 end
endif
if ndnpatop .gt. 0 then
   calc cnt1 = @cnt2 + 1
   calc cnt2 = @cnt1 + @ndnpatop - 1
   rename resname DNPA select segid UPPO .and. resid @cnt1:@cnt2 end
endif
if ndopatop .gt. 0 then
   calc cnt1 = @cnt2 + 1
   calc cnt2 = @cnt1 + @ndopatop - 1
   rename resname DOPA select segid UPPO .and. resid @cnt1:@cnt2 end
endif
if ndppatop .gt. 0 then
   calc cnt1 = @cnt2 + 1
   calc cnt2 = @cnt1 + @ndppatop - 1
   rename resname DPPA select segid UPPO .and. resid @cnt1:@cnt2 end
endif
if ndrpatop .gt. 0 then
   calc cnt1 = @cnt2 + 1
   calc cnt2 = @cnt1 + @ndrpatop - 1
   rename resname DRPA select segid UPPO .and. resid @cnt1:@cnt2 end
endif
if ndtpatop .gt. 0 then
   calc cnt1 = @cnt2 + 1
   calc cnt2 = @cnt1 + @ndtpatop - 1
   rename resname DTPA select segid UPPO .and. resid @cnt1:@cnt2 end
endif
if ndvpatop .gt. 0 then
   calc cnt1 = @cnt2 + 1
   calc cnt2 = @cnt1 + @ndvpatop - 1
   rename resname DVPA select segid UPPO .and. resid @cnt1:@cnt2 end
endif
if ndxpatop .gt. 0 then
   calc cnt1 = @cnt2 + 1
   calc cnt2 = @cnt1 + @ndxpatop - 1
   rename resname DXPA select segid UPPO .and. resid @cnt1:@cnt2 end
endif
if ndypatop .gt. 0 then
   calc cnt1 = @cnt2 + 1
   calc cnt2 = @cnt1 + @ndypatop - 1
   rename resname DYPA select segid UPPO .and. resid @cnt1:@cnt2 end
endif
if nlppatop .gt. 0 then
   calc cnt1 = @cnt2 + 1
   calc cnt2 = @cnt1 + @nlppatop - 1
   rename resname LPPA select segid UPPO .and. resid @cnt1:@cnt2 end
endif
if npapatop .gt. 0 then
   calc cnt1 = @cnt2 + 1
   calc cnt2 = @cnt1 + @npapatop - 1
   rename resname PAPA select segid UPPO .and. resid @cnt1:@cnt2 end
endif
if npgpatop .gt. 0 then
   calc cnt1 = @cnt2 + 1
   calc cnt2 = @cnt1 + @npgpatop - 1
   rename resname PGPA select segid UPPO .and. resid @cnt1:@cnt2 end
endif
if npipatop .gt. 0 then
   calc cnt1 = @cnt2 + 1
   calc cnt2 = @cnt1 + @npipatop - 1
   rename resname PIPA select segid UPPO .and. resid @cnt1:@cnt2 end
endif
if npopatop .gt. 0 then
   calc cnt1 = @cnt2 + 1
   calc cnt2 = @cnt1 + @npopatop - 1
   rename resname POPA select segid UPPO .and. resid @cnt1:@cnt2 end
endif
if nprpatop .gt. 0 then
   calc cnt1 = @cnt2 + 1
   calc cnt2 = @cnt1 + @nprpatop - 1
   rename resname PRPA select segid UPPO .and. resid @cnt1:@cnt2 end
endif
if npupatop .gt. 0 then
   calc cnt1 = @cnt2 + 1
   calc cnt2 = @cnt1 + @npupatop - 1
   rename resname PUPA select segid UPPO .and. resid @cnt1:@cnt2 end
endif
if ndapctop .gt. 0 then
   calc cnt1 = @cnt2 + 1
   calc cnt2 = @cnt1 + @ndapctop - 1
   rename resname DAPC select segid UPPO .and. resid @cnt1:@cnt2 end
endif
if ndbpctop .gt. 0 then
   calc cnt1 = @cnt2 + 1
   calc cnt2 = @cnt1 + @ndbpctop - 1
   rename resname DBPC select segid UPPO .and. resid @cnt1:@cnt2 end
endif
if ndfpctop .gt. 0 then
   calc cnt1 = @cnt2 + 1
   calc cnt2 = @cnt1 + @ndfpctop - 1
   rename resname DFPC select segid UPPO .and. resid @cnt1:@cnt2 end
endif
if ndgpctop .gt. 0 then
   calc cnt1 = @cnt2 + 1
   calc cnt2 = @cnt1 + @ndgpctop - 1
   rename resname DGPC select segid UPPO .and. resid @cnt1:@cnt2 end
endif
if ndipctop .gt. 0 then
   calc cnt1 = @cnt2 + 1
   calc cnt2 = @cnt1 + @ndipctop - 1
   rename resname DIPC select segid UPPO .and. resid @cnt1:@cnt2 end
endif
if ndlpctop .gt. 0 then
   calc cnt1 = @cnt2 + 1
   calc cnt2 = @cnt1 + @ndlpctop - 1
   rename resname DLPC select segid UPPO .and. resid @cnt1:@cnt2 end
endif
if ndnpctop .gt. 0 then
   calc cnt1 = @cnt2 + 1
   calc cnt2 = @cnt1 + @ndnpctop - 1
   rename resname DNPC select segid UPPO .and. resid @cnt1:@cnt2 end
endif
if ndopctop .gt. 0 then
   calc cnt1 = @cnt2 + 1
   calc cnt2 = @cnt1 + @ndopctop - 1
   rename resname DOPC select segid UPPO .and. resid @cnt1:@cnt2 end
endif
if ndppctop .gt. 0 then
   calc cnt1 = @cnt2 + 1
   calc cnt2 = @cnt1 + @ndppctop - 1
   rename resname DPPC select segid UPPO .and. resid @cnt1:@cnt2 end
endif
if ndrpctop .gt. 0 then
   calc cnt1 = @cnt2 + 1
   calc cnt2 = @cnt1 + @ndrpctop - 1
   rename resname DRPC select segid UPPO .and. resid @cnt1:@cnt2 end
endif
if ndtpctop .gt. 0 then
   calc cnt1 = @cnt2 + 1
   calc cnt2 = @cnt1 + @ndtpctop - 1
   rename resname DTPC select segid UPPO .and. resid @cnt1:@cnt2 end
endif
if ndvpctop .gt. 0 then
   calc cnt1 = @cnt2 + 1
   calc cnt2 = @cnt1 + @ndvpctop - 1
   rename resname DVPC select segid UPPO .and. resid @cnt1:@cnt2 end
endif
if ndxpctop .gt. 0 then
   calc cnt1 = @cnt2 + 1
   calc cnt2 = @cnt1 + @ndxpctop - 1
   rename resname DXPC select segid UPPO .and. resid @cnt1:@cnt2 end
endif
if ndypctop .gt. 0 then
   calc cnt1 = @cnt2 + 1
   calc cnt2 = @cnt1 + @ndypctop - 1
   rename resname DYPC select segid UPPO .and. resid @cnt1:@cnt2 end
endif
if nlppctop .gt. 0 then
   calc cnt1 = @cnt2 + 1
   calc cnt2 = @cnt1 + @nlppctop - 1
   rename resname LPPC select segid UPPO .and. resid @cnt1:@cnt2 end
endif
if npapctop .gt. 0 then
   calc cnt1 = @cnt2 + 1
   calc cnt2 = @cnt1 + @npapctop - 1
   rename resname PAPC select segid UPPO .and. resid @cnt1:@cnt2 end
endif
if npepctop .gt. 0 then
   calc cnt1 = @cnt2 + 1
   calc cnt2 = @cnt1 + @npepctop - 1
   rename resname PEPC select segid UPPO .and. resid @cnt1:@cnt2 end
endif
if npgpctop .gt. 0 then
   calc cnt1 = @cnt2 + 1
   calc cnt2 = @cnt1 + @npgpctop - 1
   rename resname PGPC select segid UPPO .and. resid @cnt1:@cnt2 end
endif
if npipctop .gt. 0 then
   calc cnt1 = @cnt2 + 1
   calc cnt2 = @cnt1 + @npipctop - 1
   rename resname PIPC select segid UPPO .and. resid @cnt1:@cnt2 end
endif
if npopctop .gt. 0 then
   calc cnt1 = @cnt2 + 1
   calc cnt2 = @cnt1 + @npopctop - 1
   rename resname POPC select segid UPPO .and. resid @cnt1:@cnt2 end
endif
if nprpctop .gt. 0 then
   calc cnt1 = @cnt2 + 1
   calc cnt2 = @cnt1 + @nprpctop - 1
   rename resname PRPC select segid UPPO .and. resid @cnt1:@cnt2 end
endif
if npupctop .gt. 0 then
   calc cnt1 = @cnt2 + 1
   calc cnt2 = @cnt1 + @npupctop - 1
   rename resname PUPC select segid UPPO .and. resid @cnt1:@cnt2 end
endif
if ndapetop .gt. 0 then
   calc cnt1 = @cnt2 + 1
   calc cnt2 = @cnt1 + @ndapetop - 1
   rename resname DAPE select segid UPPO .and. resid @cnt1:@cnt2 end
endif
if ndbpetop .gt. 0 then
   calc cnt1 = @cnt2 + 1
   calc cnt2 = @cnt1 + @ndbpetop - 1
   rename resname DBPE select segid UPPO .and. resid @cnt1:@cnt2 end
endif
if ndfpetop .gt. 0 then
   calc cnt1 = @cnt2 + 1
   calc cnt2 = @cnt1 + @ndfpetop - 1
   rename resname DFPE select segid UPPO .and. resid @cnt1:@cnt2 end
endif
if ndgpetop .gt. 0 then
   calc cnt1 = @cnt2 + 1
   calc cnt2 = @cnt1 + @ndgpetop - 1
   rename resname DGPE select segid UPPO .and. resid @cnt1:@cnt2 end
endif
if ndipetop .gt. 0 then
   calc cnt1 = @cnt2 + 1
   calc cnt2 = @cnt1 + @ndipetop - 1
   rename resname DIPE select segid UPPO .and. resid @cnt1:@cnt2 end
endif
if ndlpetop .gt. 0 then
   calc cnt1 = @cnt2 + 1
   calc cnt2 = @cnt1 + @ndlpetop - 1
   rename resname DLPE select segid UPPO .and. resid @cnt1:@cnt2 end
endif
if ndnpetop .gt. 0 then
   calc cnt1 = @cnt2 + 1
   calc cnt2 = @cnt1 + @ndnpetop - 1
   rename resname DNPE select segid UPPO .and. resid @cnt1:@cnt2 end
endif
if ndopetop .gt. 0 then
   calc cnt1 = @cnt2 + 1
   calc cnt2 = @cnt1 + @ndopetop - 1
   rename resname DOPE select segid UPPO .and. resid @cnt1:@cnt2 end
endif
if ndppetop .gt. 0 then
   calc cnt1 = @cnt2 + 1
   calc cnt2 = @cnt1 + @ndppetop - 1
   rename resname DPPE select segid UPPO .and. resid @cnt1:@cnt2 end
endif
if ndrpetop .gt. 0 then
   calc cnt1 = @cnt2 + 1
   calc cnt2 = @cnt1 + @ndrpetop - 1
   rename resname DRPE select segid UPPO .and. resid @cnt1:@cnt2 end
endif
if ndtpetop .gt. 0 then
   calc cnt1 = @cnt2 + 1
   calc cnt2 = @cnt1 + @ndtpetop - 1
   rename resname DTPE select segid UPPO .and. resid @cnt1:@cnt2 end
endif
if ndupetop .gt. 0 then
   calc cnt1 = @cnt2 + 1
   calc cnt2 = @cnt1 + @ndupetop - 1
   rename resname DUPE select segid UPPO .and. resid @cnt1:@cnt2 end
endif
if ndvpetop .gt. 0 then
   calc cnt1 = @cnt2 + 1
   calc cnt2 = @cnt1 + @ndvpetop - 1
   rename resname DVPE select segid UPPO .and. resid @cnt1:@cnt2 end
endif
if ndxpetop .gt. 0 then
   calc cnt1 = @cnt2 + 1
   calc cnt2 = @cnt1 + @ndxpetop - 1
   rename resname DXPE select segid UPPO .and. resid @cnt1:@cnt2 end
endif
if ndypetop .gt. 0 then
   calc cnt1 = @cnt2 + 1
   calc cnt2 = @cnt1 + @ndypetop - 1
   rename resname DYPE select segid UPPO .and. resid @cnt1:@cnt2 end
endif
if nlppetop .gt. 0 then
   calc cnt1 = @cnt2 + 1
   calc cnt2 = @cnt1 + @nlppetop - 1
   rename resname LPPE select segid UPPO .and. resid @cnt1:@cnt2 end
endif
if npapetop .gt. 0 then
   calc cnt1 = @cnt2 + 1
   calc cnt2 = @cnt1 + @npapetop - 1
   rename resname PAPE select segid UPPO .and. resid @cnt1:@cnt2 end
endif
if npgpetop .gt. 0 then
   calc cnt1 = @cnt2 + 1
   calc cnt2 = @cnt1 + @npgpetop - 1
   rename resname PGPE select segid UPPO .and. resid @cnt1:@cnt2 end
endif
if npipetop .gt. 0 then
   calc cnt1 = @cnt2 + 1
   calc cnt2 = @cnt1 + @npipetop - 1
   rename resname PIPE select segid UPPO .and. resid @cnt1:@cnt2 end
endif
if npopetop .gt. 0 then
   calc cnt1 = @cnt2 + 1
   calc cnt2 = @cnt1 + @npopetop - 1
   rename resname POPE select segid UPPO .and. resid @cnt1:@cnt2 end
endif
if npqpetop .gt. 0 then
   calc cnt1 = @cnt2 + 1
   calc cnt2 = @cnt1 + @npqpetop - 1
   rename resname PQPE select segid UPPO .and. resid @cnt1:@cnt2 end
endif
if nprpetop .gt. 0 then
   calc cnt1 = @cnt2 + 1
   calc cnt2 = @cnt1 + @nprpetop - 1
   rename resname PRPE select segid UPPO .and. resid @cnt1:@cnt2 end
endif
if npupetop .gt. 0 then
   calc cnt1 = @cnt2 + 1
   calc cnt2 = @cnt1 + @npupetop - 1
   rename resname PUPE select segid UPPO .and. resid @cnt1:@cnt2 end
endif
if ndapgtop .gt. 0 then
   calc cnt1 = @cnt2 + 1
   calc cnt2 = @cnt1 + @ndapgtop - 1
   rename resname DAPG select segid UPPO .and. resid @cnt1:@cnt2 end
endif
if ndbpgtop .gt. 0 then
   calc cnt1 = @cnt2 + 1
   calc cnt2 = @cnt1 + @ndbpgtop - 1
   rename resname DBPG select segid UPPO .and. resid @cnt1:@cnt2 end
endif
if ndfpgtop .gt. 0 then
   calc cnt1 = @cnt2 + 1
   calc cnt2 = @cnt1 + @ndfpgtop - 1
   rename resname DFPG select segid UPPO .and. resid @cnt1:@cnt2 end
endif
if ndgpgtop .gt. 0 then
   calc cnt1 = @cnt2 + 1
   calc cnt2 = @cnt1 + @ndgpgtop - 1
   rename resname DGPG select segid UPPO .and. resid @cnt1:@cnt2 end
endif
if ndipgtop .gt. 0 then
   calc cnt1 = @cnt2 + 1
   calc cnt2 = @cnt1 + @ndipgtop - 1
   rename resname DIPG select segid UPPO .and. resid @cnt1:@cnt2 end
endif
if ndlpgtop .gt. 0 then
   calc cnt1 = @cnt2 + 1
   calc cnt2 = @cnt1 + @ndlpgtop - 1
   rename resname DLPG select segid UPPO .and. resid @cnt1:@cnt2 end
endif
if ndnpgtop .gt. 0 then
   calc cnt1 = @cnt2 + 1
   calc cnt2 = @cnt1 + @ndnpgtop - 1
   rename resname DNPG select segid UPPO .and. resid @cnt1:@cnt2 end
endif
if ndopgtop .gt. 0 then
   calc cnt1 = @cnt2 + 1
   calc cnt2 = @cnt1 + @ndopgtop - 1
   rename resname DOPG select segid UPPO .and. resid @cnt1:@cnt2 end
endif
if ndppgtop .gt. 0 then
   calc cnt1 = @cnt2 + 1
   calc cnt2 = @cnt1 + @ndppgtop - 1
   rename resname DPPG select segid UPPO .and. resid @cnt1:@cnt2 end
endif
if ndrpgtop .gt. 0 then
   calc cnt1 = @cnt2 + 1
   calc cnt2 = @cnt1 + @ndrpgtop - 1
   rename resname DRPG select segid UPPO .and. resid @cnt1:@cnt2 end
endif
if ndtpgtop .gt. 0 then
   calc cnt1 = @cnt2 + 1
   calc cnt2 = @cnt1 + @ndtpgtop - 1
   rename resname DTPG select segid UPPO .and. resid @cnt1:@cnt2 end
endif
if ndvpgtop .gt. 0 then
   calc cnt1 = @cnt2 + 1
   calc cnt2 = @cnt1 + @ndvpgtop - 1
   rename resname DVPG select segid UPPO .and. resid @cnt1:@cnt2 end
endif
if ndxpgtop .gt. 0 then
   calc cnt1 = @cnt2 + 1
   calc cnt2 = @cnt1 + @ndxpgtop - 1
   rename resname DXPG select segid UPPO .and. resid @cnt1:@cnt2 end
endif
if ndypgtop .gt. 0 then
   calc cnt1 = @cnt2 + 1
   calc cnt2 = @cnt1 + @ndypgtop - 1
   rename resname DYPG select segid UPPO .and. resid @cnt1:@cnt2 end
endif
if njfpgtop .gt. 0 then
   calc cnt1 = @cnt2 + 1
   calc cnt2 = @cnt1 + @njfpgtop - 1
   rename resname JFPG select segid UPPO .and. resid @cnt1:@cnt2 end
endif
if njppgtop .gt. 0 then
   calc cnt1 = @cnt2 + 1
   calc cnt2 = @cnt1 + @njppgtop - 1
   rename resname JPPG select segid UPPO .and. resid @cnt1:@cnt2 end
endif
if nlppgtop .gt. 0 then
   calc cnt1 = @cnt2 + 1
   calc cnt2 = @cnt1 + @nlppgtop - 1
   rename resname LPPG select segid UPPO .and. resid @cnt1:@cnt2 end
endif
if noppgtop .gt. 0 then
   calc cnt1 = @cnt2 + 1
   calc cnt2 = @cnt1 + @noppgtop - 1
   rename resname OPPG select segid UPPO .and. resid @cnt1:@cnt2 end
endif
if npapgtop .gt. 0 then
   calc cnt1 = @cnt2 + 1
   calc cnt2 = @cnt1 + @npapgtop - 1
   rename resname PAPG select segid UPPO .and. resid @cnt1:@cnt2 end
endif
if npgpgtop .gt. 0 then
   calc cnt1 = @cnt2 + 1
   calc cnt2 = @cnt1 + @npgpgtop - 1
   rename resname PGPG select segid UPPO .and. resid @cnt1:@cnt2 end
endif
if npipgtop .gt. 0 then
   calc cnt1 = @cnt2 + 1
   calc cnt2 = @cnt1 + @npipgtop - 1
   rename resname PIPG select segid UPPO .and. resid @cnt1:@cnt2 end
endif
if npopgtop .gt. 0 then
   calc cnt1 = @cnt2 + 1
   calc cnt2 = @cnt1 + @npopgtop - 1
   rename resname POPG select segid UPPO .and. resid @cnt1:@cnt2 end
endif
if nprpgtop .gt. 0 then
   calc cnt1 = @cnt2 + 1
   calc cnt2 = @cnt1 + @nprpgtop - 1
   rename resname PRPG select segid UPPO .and. resid @cnt1:@cnt2 end
endif
if ndapstop .gt. 0 then
   calc cnt1 = @cnt2 + 1
   calc cnt2 = @cnt1 + @ndapstop - 1
   rename resname DAPS select segid UPPO .and. resid @cnt1:@cnt2 end
endif
if ndbpstop .gt. 0 then
   calc cnt1 = @cnt2 + 1
   calc cnt2 = @cnt1 + @ndbpstop - 1
   rename resname DBPS select segid UPPO .and. resid @cnt1:@cnt2 end
endif
if ndfpstop .gt. 0 then
   calc cnt1 = @cnt2 + 1
   calc cnt2 = @cnt1 + @ndfpstop - 1
   rename resname DFPS select segid UPPO .and. resid @cnt1:@cnt2 end
endif
if ndgpstop .gt. 0 then
   calc cnt1 = @cnt2 + 1
   calc cnt2 = @cnt1 + @ndgpstop - 1
   rename resname DGPS select segid UPPO .and. resid @cnt1:@cnt2 end
endif
if ndipstop .gt. 0 then
   calc cnt1 = @cnt2 + 1
   calc cnt2 = @cnt1 + @ndipstop - 1
   rename resname DIPS select segid UPPO .and. resid @cnt1:@cnt2 end
endif
if ndlpstop .gt. 0 then
   calc cnt1 = @cnt2 + 1
   calc cnt2 = @cnt1 + @ndlpstop - 1
   rename resname DLPS select segid UPPO .and. resid @cnt1:@cnt2 end
endif
if ndnpstop .gt. 0 then
   calc cnt1 = @cnt2 + 1
   calc cnt2 = @cnt1 + @ndnpstop - 1
   rename resname DNPS select segid UPPO .and. resid @cnt1:@cnt2 end
endif
if ndopstop .gt. 0 then
   calc cnt1 = @cnt2 + 1
   calc cnt2 = @cnt1 + @ndopstop - 1
   rename resname DOPS select segid UPPO .and. resid @cnt1:@cnt2 end
endif
if ndppstop .gt. 0 then
   calc cnt1 = @cnt2 + 1
   calc cnt2 = @cnt1 + @ndppstop - 1
   rename resname DPPS select segid UPPO .and. resid @cnt1:@cnt2 end
endif
if ndrpstop .gt. 0 then
   calc cnt1 = @cnt2 + 1
   calc cnt2 = @cnt1 + @ndrpstop - 1
   rename resname DRPS select segid UPPO .and. resid @cnt1:@cnt2 end
endif
if ndtpstop .gt. 0 then
   calc cnt1 = @cnt2 + 1
   calc cnt2 = @cnt1 + @ndtpstop - 1
   rename resname DTPS select segid UPPO .and. resid @cnt1:@cnt2 end
endif
if ndupstop .gt. 0 then
   calc cnt1 = @cnt2 + 1
   calc cnt2 = @cnt1 + @ndupstop - 1
   rename resname DUPS select segid UPPO .and. resid @cnt1:@cnt2 end
endif
if ndvpstop .gt. 0 then
   calc cnt1 = @cnt2 + 1
   calc cnt2 = @cnt1 + @ndvpstop - 1
   rename resname DVPS select segid UPPO .and. resid @cnt1:@cnt2 end
endif
if ndxpstop .gt. 0 then
   calc cnt1 = @cnt2 + 1
   calc cnt2 = @cnt1 + @ndxpstop - 1
   rename resname DXPS select segid UPPO .and. resid @cnt1:@cnt2 end
endif
if ndypstop .gt. 0 then
   calc cnt1 = @cnt2 + 1
   calc cnt2 = @cnt1 + @ndypstop - 1
   rename resname DYPS select segid UPPO .and. resid @cnt1:@cnt2 end
endif
if nlppstop .gt. 0 then
   calc cnt1 = @cnt2 + 1
   calc cnt2 = @cnt1 + @nlppstop - 1
   rename resname LPPS select segid UPPO .and. resid @cnt1:@cnt2 end
endif
if npapstop .gt. 0 then
   calc cnt1 = @cnt2 + 1
   calc cnt2 = @cnt1 + @npapstop - 1
   rename resname PAPS select segid UPPO .and. resid @cnt1:@cnt2 end
endif
if npgpstop .gt. 0 then
   calc cnt1 = @cnt2 + 1
   calc cnt2 = @cnt1 + @npgpstop - 1
   rename resname PGPS select segid UPPO .and. resid @cnt1:@cnt2 end
endif
if npipstop .gt. 0 then
   calc cnt1 = @cnt2 + 1
   calc cnt2 = @cnt1 + @npipstop - 1
   rename resname PIPS select segid UPPO .and. resid @cnt1:@cnt2 end
endif
if npopstop .gt. 0 then
   calc cnt1 = @cnt2 + 1
   calc cnt2 = @cnt1 + @npopstop - 1
   rename resname POPS select segid UPPO .and. resid @cnt1:@cnt2 end
endif
if npqpstop .gt. 0 then
   calc cnt1 = @cnt2 + 1
   calc cnt2 = @cnt1 + @npqpstop - 1
   rename resname PQPS select segid UPPO .and. resid @cnt1:@cnt2 end
endif
if nprpstop .gt. 0 then
   calc cnt1 = @cnt2 + 1
   calc cnt2 = @cnt1 + @nprpstop - 1
   rename resname PRPS select segid UPPO .and. resid @cnt1:@cnt2 end
endif
if npupstop .gt. 0 then
   calc cnt1 = @cnt2 + 1
   calc cnt2 = @cnt1 + @npupstop - 1
   rename resname PUPS select segid UPPO .and. resid @cnt1:@cnt2 end
endif
if ndpp1top .gt. 0 then
   calc cnt1 = @cnt2 + 1
   calc cnt2 = @cnt1 + @ndpp1top - 1
   rename resname DPP1 select segid UPPO .and. resid @cnt1:@cnt2 end
endif
if ndpp2top .gt. 0 then
   calc cnt1 = @cnt2 + 1
   calc cnt2 = @cnt1 + @ndpp2top - 1
   rename resname DPP2 select segid UPPO .and. resid @cnt1:@cnt2 end
endif
if ndppitop .gt. 0 then
   calc cnt1 = @cnt2 + 1
   calc cnt2 = @cnt1 + @ndppitop - 1
   rename resname DPPI select segid UPPO .and. resid @cnt1:@cnt2 end
endif
if npapitop .gt. 0 then
   calc cnt1 = @cnt2 + 1
   calc cnt2 = @cnt1 + @npapitop - 1
   rename resname PAPI select segid UPPO .and. resid @cnt1:@cnt2 end
endif
if npipitop .gt. 0 then
   calc cnt1 = @cnt2 + 1
   calc cnt2 = @cnt1 + @npipitop - 1
   rename resname PIPI select segid UPPO .and. resid @cnt1:@cnt2 end
endif
if npop1top .gt. 0 then
   calc cnt1 = @cnt2 + 1
   calc cnt2 = @cnt1 + @npop1top - 1
   rename resname POP1 select segid UPPO .and. resid @cnt1:@cnt2 end
endif
if npop2top .gt. 0 then
   calc cnt1 = @cnt2 + 1
   calc cnt2 = @cnt1 + @npop2top - 1
   rename resname POP2 select segid UPPO .and. resid @cnt1:@cnt2 end
endif
if npop3top .gt. 0 then
   calc cnt1 = @cnt2 + 1
   calc cnt2 = @cnt1 + @npop3top - 1
   rename resname POP3 select segid UPPO .and. resid @cnt1:@cnt2 end
endif
if npopitop .gt. 0 then
   calc cnt1 = @cnt2 + 1
   calc cnt2 = @cnt1 + @npopitop - 1
   rename resname POPI select segid UPPO .and. resid @cnt1:@cnt2 end
endif
if npupitop .gt. 0 then
   calc cnt1 = @cnt2 + 1
   calc cnt2 = @cnt1 + @npupitop - 1
   rename resname PUPI select segid UPPO .and. resid @cnt1:@cnt2 end
endif
if npvp1top .gt. 0 then
   calc cnt1 = @cnt2 + 1
   calc cnt2 = @cnt1 + @npvp1top - 1
   rename resname PVP1 select segid UPPO .and. resid @cnt1:@cnt2 end
endif
if npvp2top .gt. 0 then
   calc cnt1 = @cnt2 + 1
   calc cnt2 = @cnt1 + @npvp2top - 1
   rename resname PVP2 select segid UPPO .and. resid @cnt1:@cnt2 end
endif
if npvp3top .gt. 0 then
   calc cnt1 = @cnt2 + 1
   calc cnt2 = @cnt1 + @npvp3top - 1
   rename resname PVP3 select segid UPPO .and. resid @cnt1:@cnt2 end
endif
if npvpitop .gt. 0 then
   calc cnt1 = @cnt2 + 1
   calc cnt2 = @cnt1 + @npvpitop - 1
   rename resname PVPI select segid UPPO .and. resid @cnt1:@cnt2 end
endif
if ncdl0top .gt. 0 then
   calc cnt1 = @cnt2 + 1
   calc cnt2 = @cnt1 + @ncdl0top - 1
   rename resname CDL0 select segid UPPO .and. resid @cnt1:@cnt2 end
   scalar type set @ipol2 sele segid UPPO .and. resid @cnt1:@cnt2 end
endif
if ncdl1top .gt. 0 then
   calc cnt1 = @cnt2 + 1
   calc cnt2 = @cnt1 + @ncdl1top - 1
   rename resname CDL1 select segid UPPO .and. resid @cnt1:@cnt2 end
   scalar type set @ipol2 sele segid UPPO .and. resid @cnt1:@cnt2 end
endif
if ncdl2top .gt. 0 then
   calc cnt1 = @cnt2 + 1
   calc cnt2 = @cnt1 + @ncdl2top - 1
   rename resname CDL2 select segid UPPO .and. resid @cnt1:@cnt2 end
   scalar type set @ipol2 sele segid UPPO .and. resid @cnt1:@cnt2 end
endif
if nbnsmtop .gt. 0 then
   calc cnt1 = @cnt2 + 1
   calc cnt2 = @cnt1 + @nbnsmtop - 1
   rename resname BNSM select segid UPPO .and. resid @cnt1:@cnt2 end
endif
if ndbsmtop .gt. 0 then
   calc cnt1 = @cnt2 + 1
   calc cnt2 = @cnt1 + @ndbsmtop - 1
   rename resname DBSM select segid UPPO .and. resid @cnt1:@cnt2 end
endif
if ndpsmtop .gt. 0 then
   calc cnt1 = @cnt2 + 1
   calc cnt2 = @cnt1 + @ndpsmtop - 1
   rename resname DPSM select segid UPPO .and. resid @cnt1:@cnt2 end
endif
if ndxsmtop .gt. 0 then
   calc cnt1 = @cnt2 + 1
   calc cnt2 = @cnt1 + @ndxsmtop - 1
   rename resname DXSM select segid UPPO .and. resid @cnt1:@cnt2 end
endif
if npgsmtop .gt. 0 then
   calc cnt1 = @cnt2 + 1
   calc cnt2 = @cnt1 + @npgsmtop - 1
   rename resname PGSM select segid UPPO .and. resid @cnt1:@cnt2 end
endif
if npnsmtop .gt. 0 then
   calc cnt1 = @cnt2 + 1
   calc cnt2 = @cnt1 + @npnsmtop - 1
   rename resname PNSM select segid UPPO .and. resid @cnt1:@cnt2 end
endif
if nposmtop .gt. 0 then
   calc cnt1 = @cnt2 + 1
   calc cnt2 = @cnt1 + @nposmtop - 1
   rename resname POSM select segid UPPO .and. resid @cnt1:@cnt2 end
endif
if npvsmtop .gt. 0 then
   calc cnt1 = @cnt2 + 1
   calc cnt2 = @cnt1 + @npvsmtop - 1
   rename resname PVSM select segid UPPO .and. resid @cnt1:@cnt2 end
endif
if nxnsmtop .gt. 0 then
   calc cnt1 = @cnt2 + 1
   calc cnt2 = @cnt1 + @nxnsmtop - 1
   rename resname XNSM select segid UPPO .and. resid @cnt1:@cnt2 end
endif
if ndpcetop .gt. 0 then
   calc cnt1 = @cnt2 + 1
   calc cnt2 = @cnt1 + @ndpcetop - 1
   rename resname DPCE select segid UPPO .and. resid @cnt1:@cnt2 end
endif
if ndxcetop .gt. 0 then
   calc cnt1 = @cnt2 + 1
   calc cnt2 = @cnt1 + @ndxcetop - 1
   rename resname DXCE select segid UPPO .and. resid @cnt1:@cnt2 end
endif
if npncetop .gt. 0 then
   calc cnt1 = @cnt2 + 1
   calc cnt2 = @cnt1 + @npncetop - 1
   rename resname PNCE select segid UPPO .and. resid @cnt1:@cnt2 end
endif
if nxncetop .gt. 0 then
   calc cnt1 = @cnt2 + 1
   calc cnt2 = @cnt1 + @nxncetop - 1
   rename resname XNCE select segid UPPO .and. resid @cnt1:@cnt2 end
endif
if npadgtop .gt. 0 then
   calc cnt1 = @cnt2 + 1
   calc cnt2 = @cnt1 + @npadgtop - 1
   rename resname PADG select segid UPPO .and. resid @cnt1:@cnt2 end
endif
if npidgtop .gt. 0 then
   calc cnt1 = @cnt2 + 1
   calc cnt2 = @cnt1 + @npidgtop - 1
   rename resname PIDG select segid UPPO .and. resid @cnt1:@cnt2 end
endif
if npodgtop .gt. 0 then
   calc cnt1 = @cnt2 + 1
   calc cnt2 = @cnt1 + @npodgtop - 1
   rename resname PODG select segid UPPO .and. resid @cnt1:@cnt2 end
endif
if npudgtop .gt. 0 then
   calc cnt1 = @cnt2 + 1
   calc cnt2 = @cnt1 + @npudgtop - 1
   rename resname PUDG select segid UPPO .and. resid @cnt1:@cnt2 end
endif
if npvdgtop .gt. 0 then
   calc cnt1 = @cnt2 + 1
   calc cnt2 = @cnt1 + @npvdgtop - 1
   rename resname PVDG select segid UPPO .and. resid @cnt1:@cnt2 end
endif
if ntogtop .gt. 0 then
   calc cnt1 = @cnt2 + 1
   calc cnt2 = @cnt1 + @ntogtop - 1
   rename resname TOG select segid UPPO .and. resid @cnt1:@cnt2 end
endif
if napctop .gt. 0 then
   calc cnt1 = @cnt2 + 1
   calc cnt2 = @cnt1 + @napctop - 1
   rename resname APC select segid UPPO .and. resid @cnt1:@cnt2 end
endif
if ncpctop .gt. 0 then
   calc cnt1 = @cnt2 + 1
   calc cnt2 = @cnt1 + @ncpctop - 1
   rename resname CPC select segid UPPO .and. resid @cnt1:@cnt2 end
endif
if nipctop .gt. 0 then
   calc cnt1 = @cnt2 + 1
   calc cnt2 = @cnt1 + @nipctop - 1
   rename resname IPC select segid UPPO .and. resid @cnt1:@cnt2 end
endif
if nlpctop .gt. 0 then
   calc cnt1 = @cnt2 + 1
   calc cnt2 = @cnt1 + @nlpctop - 1
   rename resname LPC select segid UPPO .and. resid @cnt1:@cnt2 end
endif
if nopctop .gt. 0 then
   calc cnt1 = @cnt2 + 1
   calc cnt2 = @cnt1 + @nopctop - 1
   rename resname OPC select segid UPPO .and. resid @cnt1:@cnt2 end
endif
if nppctop .gt. 0 then
   calc cnt1 = @cnt2 + 1
   calc cnt2 = @cnt1 + @nppctop - 1
   rename resname PPC select segid UPPO .and. resid @cnt1:@cnt2 end
endif
if ntpctop .gt. 0 then
   calc cnt1 = @cnt2 + 1
   calc cnt2 = @cnt1 + @ntpctop - 1
   rename resname TPC select segid UPPO .and. resid @cnt1:@cnt2 end
endif
if nupctop .gt. 0 then
   calc cnt1 = @cnt2 + 1
   calc cnt2 = @cnt1 + @nupctop - 1
   rename resname UPC select segid UPPO .and. resid @cnt1:@cnt2 end
endif
if nvpctop .gt. 0 then
   calc cnt1 = @cnt2 + 1
   calc cnt2 = @cnt1 + @nvpctop - 1
   rename resname VPC select segid UPPO .and. resid @cnt1:@cnt2 end
endif
if nacatop .gt. 0 then
   calc cnt1 = @cnt2 + 1
   calc cnt2 = @cnt1 + @nacatop - 1
   rename resname ACA select segid UPPO .and. resid @cnt1:@cnt2 end
   scalar type set @ipolf sele segid UPPO .and. resid @cnt1:@cnt2 end
endif
if nacntop .gt. 0 then
   calc cnt1 = @cnt2 + 1
   calc cnt2 = @cnt1 + @nacntop - 1
   rename resname ACN select segid UPPO .and. resid @cnt1:@cnt2 end
   scalar type set @ipolf sele segid UPPO .and. resid @cnt1:@cnt2 end
endif
if nbcatop .gt. 0 then
   calc cnt1 = @cnt2 + 1
   calc cnt2 = @cnt1 + @nbcatop - 1
   rename resname BCA select segid UPPO .and. resid @cnt1:@cnt2 end
   scalar type set @ipolf sele segid UPPO .and. resid @cnt1:@cnt2 end
endif
if nbcntop .gt. 0 then
   calc cnt1 = @cnt2 + 1
   calc cnt2 = @cnt1 + @nbcntop - 1
   rename resname BCN select segid UPPO .and. resid @cnt1:@cnt2 end
   scalar type set @ipolf sele segid UPPO .and. resid @cnt1:@cnt2 end
endif
if nlcatop .gt. 0 then
   calc cnt1 = @cnt2 + 1
   calc cnt2 = @cnt1 + @nlcatop - 1
   rename resname LCA select segid UPPO .and. resid @cnt1:@cnt2 end
   scalar type set @ipolf sele segid UPPO .and. resid @cnt1:@cnt2 end
endif
if nlcntop .gt. 0 then
   calc cnt1 = @cnt2 + 1
   calc cnt2 = @cnt1 + @nlcntop - 1
   rename resname LCN select segid UPPO .and. resid @cnt1:@cnt2 end
   scalar type set @ipolf sele segid UPPO .and. resid @cnt1:@cnt2 end
endif
if npcntop .gt. 0 then
   calc cnt1 = @cnt2 + 1
   calc cnt2 = @cnt1 + @npcntop - 1
   rename resname PCN select segid UPPO .and. resid @cnt1:@cnt2 end
   scalar type set @ipolf sele segid UPPO .and. resid @cnt1:@cnt2 end
endif
if nucatop .gt. 0 then
   calc cnt1 = @cnt2 + 1
   calc cnt2 = @cnt1 + @nucatop - 1
   rename resname UCA select segid UPPO .and. resid @cnt1:@cnt2 end
   scalar type set @ipolf sele segid UPPO .and. resid @cnt1:@cnt2 end
endif
if nucntop .gt. 0 then
   calc cnt1 = @cnt2 + 1
   calc cnt2 = @cnt1 + @nucntop - 1
   rename resname UCN select segid UPPO .and. resid @cnt1:@cnt2 end
   scalar type set @ipolf sele segid UPPO .and. resid @cnt1:@cnt2 end
endif
if nxcatop .gt. 0 then
   calc cnt1 = @cnt2 + 1
   calc cnt2 = @cnt1 + @nxcatop - 1
   rename resname XCA select segid UPPO .and. resid @cnt1:@cnt2 end
   scalar type set @ipolf sele segid UPPO .and. resid @cnt1:@cnt2 end
endif
if nxcntop .gt. 0 then
   calc cnt1 = @cnt2 + 1
   calc cnt2 = @cnt1 + @nxcntop - 1
   rename resname XCN select segid UPPO .and. resid @cnt1:@cnt2 end
   scalar type set @ipolf sele segid UPPO .and. resid @cnt1:@cnt2 end
endif
if npcatop .gt. 0 then
   calc cnt1 = @cnt2 + 1
   calc cnt2 = @cnt1 + @npcatop - 1
   rename resname PCA select segid UPPO .and. resid @cnt1:@cnt2 end
   scalar type set @ipolf sele segid UPPO .and. resid @cnt1:@cnt2 end
endif
if nbogtop .gt. 0 then
   calc cnt1 = @cnt2 + 1
   calc cnt2 = @cnt1 + @nbogtop - 1
   rename resname BOG select segid UPPO .and. resid @cnt1:@cnt2 end
endif
if nddmtop .gt. 0 then
   calc cnt1 = @cnt2 + 1
   calc cnt2 = @cnt1 + @nddmtop - 1
   rename resname DDM select segid UPPO .and. resid @cnt1:@cnt2 end
endif
if ndpctop .gt. 0 then
   calc cnt1 = @cnt2 + 1
   calc cnt2 = @cnt1 + @ndpctop - 1
   rename resname DPC select segid UPPO .and. resid @cnt1:@cnt2 end
endif
if neo5top .gt. 0 then
   calc cnt1 = @cnt2 + 1
   calc cnt2 = @cnt1 + @neo5top - 1
   rename resname EO5 select segid UPPO .and. resid @cnt1:@cnt2 end
endif
if nsdstop .gt. 0 then
   calc cnt1 = @cnt2 + 1
   calc cnt2 = @cnt1 + @nsdstop - 1
   rename resname SDS select segid UPPO .and. resid @cnt1:@cnt2 end
endif
if ndbg1top .gt. 0 then
   calc cnt1 = @cnt2 + 1
   calc cnt2 = @cnt1 + @ndbg1top - 1
   rename resname DBG1 select segid UPPO .and. resid @cnt1:@cnt2 end
endif
if ndbg3top .gt. 0 then
   calc cnt1 = @cnt2 + 1
   calc cnt2 = @cnt1 + @ndbg3top - 1
   rename resname DBG3 select segid UPPO .and. resid @cnt1:@cnt2 end
endif
if ndfggtop .gt. 0 then
   calc cnt1 = @cnt2 + 1
   calc cnt2 = @cnt1 + @ndfggtop - 1
   rename resname DFGG select segid UPPO .and. resid @cnt1:@cnt2 end
endif
if ndfmgtop .gt. 0 then
   calc cnt1 = @cnt2 + 1
   calc cnt2 = @cnt1 + @ndfmgtop - 1
   rename resname DFMG select segid UPPO .and. resid @cnt1:@cnt2 end
endif
if ndpg1top .gt. 0 then
   calc cnt1 = @cnt2 + 1
   calc cnt2 = @cnt1 + @ndpg1top - 1
   rename resname DPG1 select segid UPPO .and. resid @cnt1:@cnt2 end
endif
if ndpg3top .gt. 0 then
   calc cnt1 = @cnt2 + 1
   calc cnt2 = @cnt1 + @ndpg3top - 1
   rename resname DPG3 select segid UPPO .and. resid @cnt1:@cnt2 end
endif
if ndpggtop .gt. 0 then
   calc cnt1 = @cnt2 + 1
   calc cnt2 = @cnt1 + @ndpggtop - 1
   rename resname DPGG select segid UPPO .and. resid @cnt1:@cnt2 end
endif
if ndpgstop .gt. 0 then
   calc cnt1 = @cnt2 + 1
   calc cnt2 = @cnt1 + @ndpgstop - 1
   rename resname DPGS select segid UPPO .and. resid @cnt1:@cnt2 end
endif
if ndpmgtop .gt. 0 then
   calc cnt1 = @cnt2 + 1
   calc cnt2 = @cnt1 + @ndpmgtop - 1
   rename resname DPMG select segid UPPO .and. resid @cnt1:@cnt2 end
endif
if ndpsgtop .gt. 0 then
   calc cnt1 = @cnt2 + 1
   calc cnt2 = @cnt1 + @ndpsgtop - 1
   rename resname DPSG select segid UPPO .and. resid @cnt1:@cnt2 end
endif
if ndxg1top .gt. 0 then
   calc cnt1 = @cnt2 + 1
   calc cnt2 = @cnt1 + @ndxg1top - 1
   rename resname DXG1 select segid UPPO .and. resid @cnt1:@cnt2 end
endif
if ndxg3top .gt. 0 then
   calc cnt1 = @cnt2 + 1
   calc cnt2 = @cnt1 + @ndxg3top - 1
   rename resname DXG3 select segid UPPO .and. resid @cnt1:@cnt2 end
endif
if nfpggtop .gt. 0 then
   calc cnt1 = @cnt2 + 1
   calc cnt2 = @cnt1 + @nfpggtop - 1
   rename resname FPGG select segid UPPO .and. resid @cnt1:@cnt2 end
endif
if nfpmgtop .gt. 0 then
   calc cnt1 = @cnt2 + 1
   calc cnt2 = @cnt1 + @nfpmgtop - 1
   rename resname FPMG select segid UPPO .and. resid @cnt1:@cnt2 end
endif
if nfpsgtop .gt. 0 then
   calc cnt1 = @cnt2 + 1
   calc cnt2 = @cnt1 + @nfpsgtop - 1
   rename resname FPSG select segid UPPO .and. resid @cnt1:@cnt2 end
endif
if nopggtop .gt. 0 then
   calc cnt1 = @cnt2 + 1
   calc cnt2 = @cnt1 + @nopggtop - 1
   rename resname OPGG select segid UPPO .and. resid @cnt1:@cnt2 end
endif
if nopmgtop .gt. 0 then
   calc cnt1 = @cnt2 + 1
   calc cnt2 = @cnt1 + @nopmgtop - 1
   rename resname OPMG select segid UPPO .and. resid @cnt1:@cnt2 end
endif
if nopsgtop .gt. 0 then
   calc cnt1 = @cnt2 + 1
   calc cnt2 = @cnt1 + @nopsgtop - 1
   rename resname OPSG select segid UPPO .and. resid @cnt1:@cnt2 end
endif
if npng1top .gt. 0 then
   calc cnt1 = @cnt2 + 1
   calc cnt2 = @cnt1 + @npng1top - 1
   rename resname PNG1 select segid UPPO .and. resid @cnt1:@cnt2 end
endif
if npng3top .gt. 0 then
   calc cnt1 = @cnt2 + 1
   calc cnt2 = @cnt1 + @npng3top - 1
   rename resname PNG3 select segid UPPO .and. resid @cnt1:@cnt2 end
endif
if nxng1top .gt. 0 then
   calc cnt1 = @cnt2 + 1
   calc cnt2 = @cnt1 + @nxng1top - 1
   rename resname XNG1 select segid UPPO .and. resid @cnt1:@cnt2 end
endif
if nxng3top .gt. 0 then
   calc cnt1 = @cnt2 + 1
   calc cnt2 = @cnt1 + @nxng3top - 1
   rename resname XNG3 select segid UPPO .and. resid @cnt1:@cnt2 end
endif
if nramptop .gt. 0 then
   calc cnt1 = @cnt2 + 1
   calc cnt2 = @cnt1 + @nramptop - 1
   rename resname RAMP select segid UPPO .and. resid @cnt1:@cnt2 end
   scalar type set @ipol4 sele segid UPPO .and. resid @cnt1:@cnt2 end
   calc nlpstop = @nlpstop + @nramptop
endif
if nremptop .gt. 0 then
   calc cnt1 = @cnt2 + 1
   calc cnt2 = @cnt1 + @nremptop - 1
   rename resname REMP select segid UPPO .and. resid @cnt1:@cnt2 end
   scalar type set @ipol4 sele segid UPPO .and. resid @cnt1:@cnt2 end
   calc nlpstop = @nlpstop + @nremptop
endif
if noanttop .gt. 0 then
   calc cnt1 = @cnt2 + 1
   calc cnt2 = @cnt1 + @noanttop - 1
   rename resname OANT select segid UPPO .and. resid @cnt1:@cnt2 end
   scalar type set @ipol4 sele segid UPPO .and. resid @cnt1:@cnt2 end
   calc nlpstop = @nlpstop + @noanttop
endif
if ndspctop .gt. 0 then
   calc cnt1 = @cnt2 + 1
   calc cnt2 = @cnt1 + @ndspctop - 1
   rename resname DSPC select segid UPPO .and. resid @cnt1:@cnt2 end
endif
if ndhpetop .gt. 0 then
   calc cnt1 = @cnt2 + 1
   calc cnt2 = @cnt1 + @ndhpetop - 1
   rename resname DHPE select segid UPPO .and. resid @cnt1:@cnt2 end
endif
if ndspetop .gt. 0 then
   calc cnt1 = @cnt2 + 1
   calc cnt2 = @cnt1 + @ndspetop - 1
   rename resname DSPE select segid UPPO .and. resid @cnt1:@cnt2 end
endif

!
! Change resnames [lower leaflet]
!

calc cnt1 = 0
calc cnt2 = 0
calc nlpsbot = 0

if nchoabot .gt. 0 then
   calc cnt1 = @cnt2 + 1
   calc cnt2 = @cnt1 + @nchoabot - 1
   rename resname CHOA select segid DNPO .and. resid @cnt1:@cnt2 end
endif
if ncholbot .gt. 0 then
   calc cnt1 = @cnt2 + 1
   calc cnt2 = @cnt1 + @ncholbot - 1
   rename resname CHOL select segid DNPO .and. resid @cnt1:@cnt2 end
endif
if nchyobot .gt. 0 then
   calc cnt1 = @cnt2 + 1
   calc cnt2 = @cnt1 + @nchyobot - 1
   rename resname CHYO select segid DNPO .and. resid @cnt1:@cnt2 end
endif
if nergobot .gt. 0 then
   calc cnt1 = @cnt2 + 1
   calc cnt2 = @cnt1 + @nergobot - 1
   rename resname ERGO select segid DNPO .and. resid @cnt1:@cnt2 end
endif
if nhbhtbot .gt. 0 then
   calc cnt1 = @cnt2 + 1
   calc cnt2 = @cnt1 + @nhbhtbot - 1
   rename resname HBHT select segid DNPO .and. resid @cnt1:@cnt2 end
endif
if nhdptbot .gt. 0 then
   calc cnt1 = @cnt2 + 1
   calc cnt2 = @cnt1 + @nhdptbot - 1
   rename resname HDPT select segid DNPO .and. resid @cnt1:@cnt2 end
endif
if nhhopbot .gt. 0 then
   calc cnt1 = @cnt2 + 1
   calc cnt2 = @cnt1 + @nhhopbot - 1
   rename resname HHOP select segid DNPO .and. resid @cnt1:@cnt2 end
endif
if nhoprbot .gt. 0 then
   calc cnt1 = @cnt2 + 1
   calc cnt2 = @cnt1 + @nhoprbot - 1
   rename resname HOPR select segid DNPO .and. resid @cnt1:@cnt2 end
endif
if ndapabot .gt. 0 then
   calc cnt1 = @cnt2 + 1
   calc cnt2 = @cnt1 + @ndapabot - 1
   rename resname DAPA select segid DNPO .and. resid @cnt1:@cnt2 end
endif
if ndbpabot .gt. 0 then
   calc cnt1 = @cnt2 + 1
   calc cnt2 = @cnt1 + @ndbpabot - 1
   rename resname DBPA select segid DNPO .and. resid @cnt1:@cnt2 end
endif
if ndfpabot .gt. 0 then
   calc cnt1 = @cnt2 + 1
   calc cnt2 = @cnt1 + @ndfpabot - 1
   rename resname DFPA select segid DNPO .and. resid @cnt1:@cnt2 end
endif
if ndgpabot .gt. 0 then
   calc cnt1 = @cnt2 + 1
   calc cnt2 = @cnt1 + @ndgpabot - 1
   rename resname DGPA select segid DNPO .and. resid @cnt1:@cnt2 end
endif
if ndipabot .gt. 0 then
   calc cnt1 = @cnt2 + 1
   calc cnt2 = @cnt1 + @ndipabot - 1
   rename resname DIPA select segid DNPO .and. resid @cnt1:@cnt2 end
endif
if ndlpabot .gt. 0 then
   calc cnt1 = @cnt2 + 1
   calc cnt2 = @cnt1 + @ndlpabot - 1
   rename resname DLPA select segid DNPO .and. resid @cnt1:@cnt2 end
endif
if ndnpabot .gt. 0 then
   calc cnt1 = @cnt2 + 1
   calc cnt2 = @cnt1 + @ndnpabot - 1
   rename resname DNPA select segid DNPO .and. resid @cnt1:@cnt2 end
endif
if ndopabot .gt. 0 then
   calc cnt1 = @cnt2 + 1
   calc cnt2 = @cnt1 + @ndopabot - 1
   rename resname DOPA select segid DNPO .and. resid @cnt1:@cnt2 end
endif
if ndppabot .gt. 0 then
   calc cnt1 = @cnt2 + 1
   calc cnt2 = @cnt1 + @ndppabot - 1
   rename resname DPPA select segid DNPO .and. resid @cnt1:@cnt2 end
endif
if ndrpabot .gt. 0 then
   calc cnt1 = @cnt2 + 1
   calc cnt2 = @cnt1 + @ndrpabot - 1
   rename resname DRPA select segid DNPO .and. resid @cnt1:@cnt2 end
endif
if ndtpabot .gt. 0 then
   calc cnt1 = @cnt2 + 1
   calc cnt2 = @cnt1 + @ndtpabot - 1
   rename resname DTPA select segid DNPO .and. resid @cnt1:@cnt2 end
endif
if ndvpabot .gt. 0 then
   calc cnt1 = @cnt2 + 1
   calc cnt2 = @cnt1 + @ndvpabot - 1
   rename resname DVPA select segid DNPO .and. resid @cnt1:@cnt2 end
endif
if ndxpabot .gt. 0 then
   calc cnt1 = @cnt2 + 1
   calc cnt2 = @cnt1 + @ndxpabot - 1
   rename resname DXPA select segid DNPO .and. resid @cnt1:@cnt2 end
endif
if ndypabot .gt. 0 then
   calc cnt1 = @cnt2 + 1
   calc cnt2 = @cnt1 + @ndypabot - 1
   rename resname DYPA select segid DNPO .and. resid @cnt1:@cnt2 end
endif
if nlppabot .gt. 0 then
   calc cnt1 = @cnt2 + 1
   calc cnt2 = @cnt1 + @nlppabot - 1
   rename resname LPPA select segid DNPO .and. resid @cnt1:@cnt2 end
endif
if npapabot .gt. 0 then
   calc cnt1 = @cnt2 + 1
   calc cnt2 = @cnt1 + @npapabot - 1
   rename resname PAPA select segid DNPO .and. resid @cnt1:@cnt2 end
endif
if npgpabot .gt. 0 then
   calc cnt1 = @cnt2 + 1
   calc cnt2 = @cnt1 + @npgpabot - 1
   rename resname PGPA select segid DNPO .and. resid @cnt1:@cnt2 end
endif
if npipabot .gt. 0 then
   calc cnt1 = @cnt2 + 1
   calc cnt2 = @cnt1 + @npipabot - 1
   rename resname PIPA select segid DNPO .and. resid @cnt1:@cnt2 end
endif
if npopabot .gt. 0 then
   calc cnt1 = @cnt2 + 1
   calc cnt2 = @cnt1 + @npopabot - 1
   rename resname POPA select segid DNPO .and. resid @cnt1:@cnt2 end
endif
if nprpabot .gt. 0 then
   calc cnt1 = @cnt2 + 1
   calc cnt2 = @cnt1 + @nprpabot - 1
   rename resname PRPA select segid DNPO .and. resid @cnt1:@cnt2 end
endif
if npupabot .gt. 0 then
   calc cnt1 = @cnt2 + 1
   calc cnt2 = @cnt1 + @npupabot - 1
   rename resname PUPA select segid DNPO .and. resid @cnt1:@cnt2 end
endif
if ndapcbot .gt. 0 then
   calc cnt1 = @cnt2 + 1
   calc cnt2 = @cnt1 + @ndapcbot - 1
   rename resname DAPC select segid DNPO .and. resid @cnt1:@cnt2 end
endif
if ndbpcbot .gt. 0 then
   calc cnt1 = @cnt2 + 1
   calc cnt2 = @cnt1 + @ndbpcbot - 1
   rename resname DBPC select segid DNPO .and. resid @cnt1:@cnt2 end
endif
if ndfpcbot .gt. 0 then
   calc cnt1 = @cnt2 + 1
   calc cnt2 = @cnt1 + @ndfpcbot - 1
   rename resname DFPC select segid DNPO .and. resid @cnt1:@cnt2 end
endif
if ndgpcbot .gt. 0 then
   calc cnt1 = @cnt2 + 1
   calc cnt2 = @cnt1 + @ndgpcbot - 1
   rename resname DGPC select segid DNPO .and. resid @cnt1:@cnt2 end
endif
if ndipcbot .gt. 0 then
   calc cnt1 = @cnt2 + 1
   calc cnt2 = @cnt1 + @ndipcbot - 1
   rename resname DIPC select segid DNPO .and. resid @cnt1:@cnt2 end
endif
if ndlpcbot .gt. 0 then
   calc cnt1 = @cnt2 + 1
   calc cnt2 = @cnt1 + @ndlpcbot - 1
   rename resname DLPC select segid DNPO .and. resid @cnt1:@cnt2 end
endif
if ndnpcbot .gt. 0 then
   calc cnt1 = @cnt2 + 1
   calc cnt2 = @cnt1 + @ndnpcbot - 1
   rename resname DNPC select segid DNPO .and. resid @cnt1:@cnt2 end
endif
if ndopcbot .gt. 0 then
   calc cnt1 = @cnt2 + 1
   calc cnt2 = @cnt1 + @ndopcbot - 1
   rename resname DOPC select segid DNPO .and. resid @cnt1:@cnt2 end
endif
if ndppcbot .gt. 0 then
   calc cnt1 = @cnt2 + 1
   calc cnt2 = @cnt1 + @ndppcbot - 1
   rename resname DPPC select segid DNPO .and. resid @cnt1:@cnt2 end
endif
if ndrpcbot .gt. 0 then
   calc cnt1 = @cnt2 + 1
   calc cnt2 = @cnt1 + @ndrpcbot - 1
   rename resname DRPC select segid DNPO .and. resid @cnt1:@cnt2 end
endif
if ndtpcbot .gt. 0 then
   calc cnt1 = @cnt2 + 1
   calc cnt2 = @cnt1 + @ndtpcbot - 1
   rename resname DTPC select segid DNPO .and. resid @cnt1:@cnt2 end
endif
if ndvpcbot .gt. 0 then
   calc cnt1 = @cnt2 + 1
   calc cnt2 = @cnt1 + @ndvpcbot - 1
   rename resname DVPC select segid DNPO .and. resid @cnt1:@cnt2 end
endif
if ndxpcbot .gt. 0 then
   calc cnt1 = @cnt2 + 1
   calc cnt2 = @cnt1 + @ndxpcbot - 1
   rename resname DXPC select segid DNPO .and. resid @cnt1:@cnt2 end
endif
if ndypcbot .gt. 0 then
   calc cnt1 = @cnt2 + 1
   calc cnt2 = @cnt1 + @ndypcbot - 1
   rename resname DYPC select segid DNPO .and. resid @cnt1:@cnt2 end
endif
if nlppcbot .gt. 0 then
   calc cnt1 = @cnt2 + 1
   calc cnt2 = @cnt1 + @nlppcbot - 1
   rename resname LPPC select segid DNPO .and. resid @cnt1:@cnt2 end
endif
if npapcbot .gt. 0 then
   calc cnt1 = @cnt2 + 1
   calc cnt2 = @cnt1 + @npapcbot - 1
   rename resname PAPC select segid DNPO .and. resid @cnt1:@cnt2 end
endif
if npepcbot .gt. 0 then
   calc cnt1 = @cnt2 + 1
   calc cnt2 = @cnt1 + @npepcbot - 1
   rename resname PEPC select segid DNPO .and. resid @cnt1:@cnt2 end
endif
if npgpcbot .gt. 0 then
   calc cnt1 = @cnt2 + 1
   calc cnt2 = @cnt1 + @npgpcbot - 1
   rename resname PGPC select segid DNPO .and. resid @cnt1:@cnt2 end
endif
if npipcbot .gt. 0 then
   calc cnt1 = @cnt2 + 1
   calc cnt2 = @cnt1 + @npipcbot - 1
   rename resname PIPC select segid DNPO .and. resid @cnt1:@cnt2 end
endif
if npopcbot .gt. 0 then
   calc cnt1 = @cnt2 + 1
   calc cnt2 = @cnt1 + @npopcbot - 1
   rename resname POPC select segid DNPO .and. resid @cnt1:@cnt2 end
endif
if nprpcbot .gt. 0 then
   calc cnt1 = @cnt2 + 1
   calc cnt2 = @cnt1 + @nprpcbot - 1
   rename resname PRPC select segid DNPO .and. resid @cnt1:@cnt2 end
endif
if npupcbot .gt. 0 then
   calc cnt1 = @cnt2 + 1
   calc cnt2 = @cnt1 + @npupcbot - 1
   rename resname PUPC select segid DNPO .and. resid @cnt1:@cnt2 end
endif
if ndapebot .gt. 0 then
   calc cnt1 = @cnt2 + 1
   calc cnt2 = @cnt1 + @ndapebot - 1
   rename resname DAPE select segid DNPO .and. resid @cnt1:@cnt2 end
endif
if ndbpebot .gt. 0 then
   calc cnt1 = @cnt2 + 1
   calc cnt2 = @cnt1 + @ndbpebot - 1
   rename resname DBPE select segid DNPO .and. resid @cnt1:@cnt2 end
endif
if ndfpebot .gt. 0 then
   calc cnt1 = @cnt2 + 1
   calc cnt2 = @cnt1 + @ndfpebot - 1
   rename resname DFPE select segid DNPO .and. resid @cnt1:@cnt2 end
endif
if ndgpebot .gt. 0 then
   calc cnt1 = @cnt2 + 1
   calc cnt2 = @cnt1 + @ndgpebot - 1
   rename resname DGPE select segid DNPO .and. resid @cnt1:@cnt2 end
endif
if ndipebot .gt. 0 then
   calc cnt1 = @cnt2 + 1
   calc cnt2 = @cnt1 + @ndipebot - 1
   rename resname DIPE select segid DNPO .and. resid @cnt1:@cnt2 end
endif
if ndlpebot .gt. 0 then
   calc cnt1 = @cnt2 + 1
   calc cnt2 = @cnt1 + @ndlpebot - 1
   rename resname DLPE select segid DNPO .and. resid @cnt1:@cnt2 end
endif
if ndnpebot .gt. 0 then
   calc cnt1 = @cnt2 + 1
   calc cnt2 = @cnt1 + @ndnpebot - 1
   rename resname DNPE select segid DNPO .and. resid @cnt1:@cnt2 end
endif
if ndopebot .gt. 0 then
   calc cnt1 = @cnt2 + 1
   calc cnt2 = @cnt1 + @ndopebot - 1
   rename resname DOPE select segid DNPO .and. resid @cnt1:@cnt2 end
endif
if ndppebot .gt. 0 then
   calc cnt1 = @cnt2 + 1
   calc cnt2 = @cnt1 + @ndppebot - 1
   rename resname DPPE select segid DNPO .and. resid @cnt1:@cnt2 end
endif
if ndrpebot .gt. 0 then
   calc cnt1 = @cnt2 + 1
   calc cnt2 = @cnt1 + @ndrpebot - 1
   rename resname DRPE select segid DNPO .and. resid @cnt1:@cnt2 end
endif
if ndtpebot .gt. 0 then
   calc cnt1 = @cnt2 + 1
   calc cnt2 = @cnt1 + @ndtpebot - 1
   rename resname DTPE select segid DNPO .and. resid @cnt1:@cnt2 end
endif
if ndupebot .gt. 0 then
   calc cnt1 = @cnt2 + 1
   calc cnt2 = @cnt1 + @ndupebot - 1
   rename resname DUPE select segid DNPO .and. resid @cnt1:@cnt2 end
endif
if ndvpebot .gt. 0 then
   calc cnt1 = @cnt2 + 1
   calc cnt2 = @cnt1 + @ndvpebot - 1
   rename resname DVPE select segid DNPO .and. resid @cnt1:@cnt2 end
endif
if ndxpebot .gt. 0 then
   calc cnt1 = @cnt2 + 1
   calc cnt2 = @cnt1 + @ndxpebot - 1
   rename resname DXPE select segid DNPO .and. resid @cnt1:@cnt2 end
endif
if ndypebot .gt. 0 then
   calc cnt1 = @cnt2 + 1
   calc cnt2 = @cnt1 + @ndypebot - 1
   rename resname DYPE select segid DNPO .and. resid @cnt1:@cnt2 end
endif
if nlppebot .gt. 0 then
   calc cnt1 = @cnt2 + 1
   calc cnt2 = @cnt1 + @nlppebot - 1
   rename resname LPPE select segid DNPO .and. resid @cnt1:@cnt2 end
endif
if npapebot .gt. 0 then
   calc cnt1 = @cnt2 + 1
   calc cnt2 = @cnt1 + @npapebot - 1
   rename resname PAPE select segid DNPO .and. resid @cnt1:@cnt2 end
endif
if npgpebot .gt. 0 then
   calc cnt1 = @cnt2 + 1
   calc cnt2 = @cnt1 + @npgpebot - 1
   rename resname PGPE select segid DNPO .and. resid @cnt1:@cnt2 end
endif
if npipebot .gt. 0 then
   calc cnt1 = @cnt2 + 1
   calc cnt2 = @cnt1 + @npipebot - 1
   rename resname PIPE select segid DNPO .and. resid @cnt1:@cnt2 end
endif
if npopebot .gt. 0 then
   calc cnt1 = @cnt2 + 1
   calc cnt2 = @cnt1 + @npopebot - 1
   rename resname POPE select segid DNPO .and. resid @cnt1:@cnt2 end
endif
if npqpebot .gt. 0 then
   calc cnt1 = @cnt2 + 1
   calc cnt2 = @cnt1 + @npqpebot - 1
   rename resname PQPE select segid DNPO .and. resid @cnt1:@cnt2 end
endif
if nprpebot .gt. 0 then
   calc cnt1 = @cnt2 + 1
   calc cnt2 = @cnt1 + @nprpebot - 1
   rename resname PRPE select segid DNPO .and. resid @cnt1:@cnt2 end
endif
if npupebot .gt. 0 then
   calc cnt1 = @cnt2 + 1
   calc cnt2 = @cnt1 + @npupebot - 1
   rename resname PUPE select segid DNPO .and. resid @cnt1:@cnt2 end
endif
if ndapgbot .gt. 0 then
   calc cnt1 = @cnt2 + 1
   calc cnt2 = @cnt1 + @ndapgbot - 1
   rename resname DAPG select segid DNPO .and. resid @cnt1:@cnt2 end
endif
if ndbpgbot .gt. 0 then
   calc cnt1 = @cnt2 + 1
   calc cnt2 = @cnt1 + @ndbpgbot - 1
   rename resname DBPG select segid DNPO .and. resid @cnt1:@cnt2 end
endif
if ndfpgbot .gt. 0 then
   calc cnt1 = @cnt2 + 1
   calc cnt2 = @cnt1 + @ndfpgbot - 1
   rename resname DFPG select segid DNPO .and. resid @cnt1:@cnt2 end
endif
if ndgpgbot .gt. 0 then
   calc cnt1 = @cnt2 + 1
   calc cnt2 = @cnt1 + @ndgpgbot - 1
   rename resname DGPG select segid DNPO .and. resid @cnt1:@cnt2 end
endif
if ndipgbot .gt. 0 then
   calc cnt1 = @cnt2 + 1
   calc cnt2 = @cnt1 + @ndipgbot - 1
   rename resname DIPG select segid DNPO .and. resid @cnt1:@cnt2 end
endif
if ndlpgbot .gt. 0 then
   calc cnt1 = @cnt2 + 1
   calc cnt2 = @cnt1 + @ndlpgbot - 1
   rename resname DLPG select segid DNPO .and. resid @cnt1:@cnt2 end
endif
if ndnpgbot .gt. 0 then
   calc cnt1 = @cnt2 + 1
   calc cnt2 = @cnt1 + @ndnpgbot - 1
   rename resname DNPG select segid DNPO .and. resid @cnt1:@cnt2 end
endif
if ndopgbot .gt. 0 then
   calc cnt1 = @cnt2 + 1
   calc cnt2 = @cnt1 + @ndopgbot - 1
   rename resname DOPG select segid DNPO .and. resid @cnt1:@cnt2 end
endif
if ndppgbot .gt. 0 then
   calc cnt1 = @cnt2 + 1
   calc cnt2 = @cnt1 + @ndppgbot - 1
   rename resname DPPG select segid DNPO .and. resid @cnt1:@cnt2 end
endif
if ndrpgbot .gt. 0 then
   calc cnt1 = @cnt2 + 1
   calc cnt2 = @cnt1 + @ndrpgbot - 1
   rename resname DRPG select segid DNPO .and. resid @cnt1:@cnt2 end
endif
if ndtpgbot .gt. 0 then
   calc cnt1 = @cnt2 + 1
   calc cnt2 = @cnt1 + @ndtpgbot - 1
   rename resname DTPG select segid DNPO .and. resid @cnt1:@cnt2 end
endif
if ndvpgbot .gt. 0 then
   calc cnt1 = @cnt2 + 1
   calc cnt2 = @cnt1 + @ndvpgbot - 1
   rename resname DVPG select segid DNPO .and. resid @cnt1:@cnt2 end
endif
if ndxpgbot .gt. 0 then
   calc cnt1 = @cnt2 + 1
   calc cnt2 = @cnt1 + @ndxpgbot - 1
   rename resname DXPG select segid DNPO .and. resid @cnt1:@cnt2 end
endif
if ndypgbot .gt. 0 then
   calc cnt1 = @cnt2 + 1
   calc cnt2 = @cnt1 + @ndypgbot - 1
   rename resname DYPG select segid DNPO .and. resid @cnt1:@cnt2 end
endif
if njfpgbot .gt. 0 then
   calc cnt1 = @cnt2 + 1
   calc cnt2 = @cnt1 + @njfpgbot - 1
   rename resname JFPG select segid DNPO .and. resid @cnt1:@cnt2 end
endif
if njppgbot .gt. 0 then
   calc cnt1 = @cnt2 + 1
   calc cnt2 = @cnt1 + @njppgbot - 1
   rename resname JPPG select segid DNPO .and. resid @cnt1:@cnt2 end
endif
if nlppgbot .gt. 0 then
   calc cnt1 = @cnt2 + 1
   calc cnt2 = @cnt1 + @nlppgbot - 1
   rename resname LPPG select segid DNPO .and. resid @cnt1:@cnt2 end
endif
if noppgbot .gt. 0 then
   calc cnt1 = @cnt2 + 1
   calc cnt2 = @cnt1 + @noppgbot - 1
   rename resname OPPG select segid DNPO .and. resid @cnt1:@cnt2 end
endif
if npapgbot .gt. 0 then
   calc cnt1 = @cnt2 + 1
   calc cnt2 = @cnt1 + @npapgbot - 1
   rename resname PAPG select segid DNPO .and. resid @cnt1:@cnt2 end
endif
if npgpgbot .gt. 0 then
   calc cnt1 = @cnt2 + 1
   calc cnt2 = @cnt1 + @npgpgbot - 1
   rename resname PGPG select segid DNPO .and. resid @cnt1:@cnt2 end
endif
if npipgbot .gt. 0 then
   calc cnt1 = @cnt2 + 1
   calc cnt2 = @cnt1 + @npipgbot - 1
   rename resname PIPG select segid DNPO .and. resid @cnt1:@cnt2 end
endif
if npopgbot .gt. 0 then
   calc cnt1 = @cnt2 + 1
   calc cnt2 = @cnt1 + @npopgbot - 1
   rename resname POPG select segid DNPO .and. resid @cnt1:@cnt2 end
endif
if nprpgbot .gt. 0 then
   calc cnt1 = @cnt2 + 1
   calc cnt2 = @cnt1 + @nprpgbot - 1
   rename resname PRPG select segid DNPO .and. resid @cnt1:@cnt2 end
endif
if ndapsbot .gt. 0 then
   calc cnt1 = @cnt2 + 1
   calc cnt2 = @cnt1 + @ndapsbot - 1
   rename resname DAPS select segid DNPO .and. resid @cnt1:@cnt2 end
endif
if ndbpsbot .gt. 0 then
   calc cnt1 = @cnt2 + 1
   calc cnt2 = @cnt1 + @ndbpsbot - 1
   rename resname DBPS select segid DNPO .and. resid @cnt1:@cnt2 end
endif
if ndfpsbot .gt. 0 then
   calc cnt1 = @cnt2 + 1
   calc cnt2 = @cnt1 + @ndfpsbot - 1
   rename resname DFPS select segid DNPO .and. resid @cnt1:@cnt2 end
endif
if ndgpsbot .gt. 0 then
   calc cnt1 = @cnt2 + 1
   calc cnt2 = @cnt1 + @ndgpsbot - 1
   rename resname DGPS select segid DNPO .and. resid @cnt1:@cnt2 end
endif
if ndipsbot .gt. 0 then
   calc cnt1 = @cnt2 + 1
   calc cnt2 = @cnt1 + @ndipsbot - 1
   rename resname DIPS select segid DNPO .and. resid @cnt1:@cnt2 end
endif
if ndlpsbot .gt. 0 then
   calc cnt1 = @cnt2 + 1
   calc cnt2 = @cnt1 + @ndlpsbot - 1
   rename resname DLPS select segid DNPO .and. resid @cnt1:@cnt2 end
endif
if ndnpsbot .gt. 0 then
   calc cnt1 = @cnt2 + 1
   calc cnt2 = @cnt1 + @ndnpsbot - 1
   rename resname DNPS select segid DNPO .and. resid @cnt1:@cnt2 end
endif
if ndopsbot .gt. 0 then
   calc cnt1 = @cnt2 + 1
   calc cnt2 = @cnt1 + @ndopsbot - 1
   rename resname DOPS select segid DNPO .and. resid @cnt1:@cnt2 end
endif
if ndppsbot .gt. 0 then
   calc cnt1 = @cnt2 + 1
   calc cnt2 = @cnt1 + @ndppsbot - 1
   rename resname DPPS select segid DNPO .and. resid @cnt1:@cnt2 end
endif
if ndrpsbot .gt. 0 then
   calc cnt1 = @cnt2 + 1
   calc cnt2 = @cnt1 + @ndrpsbot - 1
   rename resname DRPS select segid DNPO .and. resid @cnt1:@cnt2 end
endif
if ndtpsbot .gt. 0 then
   calc cnt1 = @cnt2 + 1
   calc cnt2 = @cnt1 + @ndtpsbot - 1
   rename resname DTPS select segid DNPO .and. resid @cnt1:@cnt2 end
endif
if ndupsbot .gt. 0 then
   calc cnt1 = @cnt2 + 1
   calc cnt2 = @cnt1 + @ndupsbot - 1
   rename resname DUPS select segid DNPO .and. resid @cnt1:@cnt2 end
endif
if ndvpsbot .gt. 0 then
   calc cnt1 = @cnt2 + 1
   calc cnt2 = @cnt1 + @ndvpsbot - 1
   rename resname DVPS select segid DNPO .and. resid @cnt1:@cnt2 end
endif
if ndxpsbot .gt. 0 then
   calc cnt1 = @cnt2 + 1
   calc cnt2 = @cnt1 + @ndxpsbot - 1
   rename resname DXPS select segid DNPO .and. resid @cnt1:@cnt2 end
endif
if ndypsbot .gt. 0 then
   calc cnt1 = @cnt2 + 1
   calc cnt2 = @cnt1 + @ndypsbot - 1
   rename resname DYPS select segid DNPO .and. resid @cnt1:@cnt2 end
endif
if nlppsbot .gt. 0 then
   calc cnt1 = @cnt2 + 1
   calc cnt2 = @cnt1 + @nlppsbot - 1
   rename resname LPPS select segid DNPO .and. resid @cnt1:@cnt2 end
endif
if npapsbot .gt. 0 then
   calc cnt1 = @cnt2 + 1
   calc cnt2 = @cnt1 + @npapsbot - 1
   rename resname PAPS select segid DNPO .and. resid @cnt1:@cnt2 end
endif
if npgpsbot .gt. 0 then
   calc cnt1 = @cnt2 + 1
   calc cnt2 = @cnt1 + @npgpsbot - 1
   rename resname PGPS select segid DNPO .and. resid @cnt1:@cnt2 end
endif
if npipsbot .gt. 0 then
   calc cnt1 = @cnt2 + 1
   calc cnt2 = @cnt1 + @npipsbot - 1
   rename resname PIPS select segid DNPO .and. resid @cnt1:@cnt2 end
endif
if npopsbot .gt. 0 then
   calc cnt1 = @cnt2 + 1
   calc cnt2 = @cnt1 + @npopsbot - 1
   rename resname POPS select segid DNPO .and. resid @cnt1:@cnt2 end
endif
if npqpsbot .gt. 0 then
   calc cnt1 = @cnt2 + 1
   calc cnt2 = @cnt1 + @npqpsbot - 1
   rename resname PQPS select segid DNPO .and. resid @cnt1:@cnt2 end
endif
if nprpsbot .gt. 0 then
   calc cnt1 = @cnt2 + 1
   calc cnt2 = @cnt1 + @nprpsbot - 1
   rename resname PRPS select segid DNPO .and. resid @cnt1:@cnt2 end
endif
if npupsbot .gt. 0 then
   calc cnt1 = @cnt2 + 1
   calc cnt2 = @cnt1 + @npupsbot - 1
   rename resname PUPS select segid DNPO .and. resid @cnt1:@cnt2 end
endif
if ndpp1bot .gt. 0 then
   calc cnt1 = @cnt2 + 1
   calc cnt2 = @cnt1 + @ndpp1bot - 1
   rename resname DPP1 select segid DNPO .and. resid @cnt1:@cnt2 end
endif
if ndpp2bot .gt. 0 then
   calc cnt1 = @cnt2 + 1
   calc cnt2 = @cnt1 + @ndpp2bot - 1
   rename resname DPP2 select segid DNPO .and. resid @cnt1:@cnt2 end
endif
if ndppibot .gt. 0 then
   calc cnt1 = @cnt2 + 1
   calc cnt2 = @cnt1 + @ndppibot - 1
   rename resname DPPI select segid DNPO .and. resid @cnt1:@cnt2 end
endif
if npapibot .gt. 0 then
   calc cnt1 = @cnt2 + 1
   calc cnt2 = @cnt1 + @npapibot - 1
   rename resname PAPI select segid DNPO .and. resid @cnt1:@cnt2 end
endif
if npipibot .gt. 0 then
   calc cnt1 = @cnt2 + 1
   calc cnt2 = @cnt1 + @npipibot - 1
   rename resname PIPI select segid DNPO .and. resid @cnt1:@cnt2 end
endif
if npop1bot .gt. 0 then
   calc cnt1 = @cnt2 + 1
   calc cnt2 = @cnt1 + @npop1bot - 1
   rename resname POP1 select segid DNPO .and. resid @cnt1:@cnt2 end
endif
if npop2bot .gt. 0 then
   calc cnt1 = @cnt2 + 1
   calc cnt2 = @cnt1 + @npop2bot - 1
   rename resname POP2 select segid DNPO .and. resid @cnt1:@cnt2 end
endif
if npop3bot .gt. 0 then
   calc cnt1 = @cnt2 + 1
   calc cnt2 = @cnt1 + @npop3bot - 1
   rename resname POP3 select segid DNPO .and. resid @cnt1:@cnt2 end
endif
if npopibot .gt. 0 then
   calc cnt1 = @cnt2 + 1
   calc cnt2 = @cnt1 + @npopibot - 1
   rename resname POPI select segid DNPO .and. resid @cnt1:@cnt2 end
endif
if npupibot .gt. 0 then
   calc cnt1 = @cnt2 + 1
   calc cnt2 = @cnt1 + @npupibot - 1
   rename resname PUPI select segid DNPO .and. resid @cnt1:@cnt2 end
endif
if npvp1bot .gt. 0 then
   calc cnt1 = @cnt2 + 1
   calc cnt2 = @cnt1 + @npvp1bot - 1
   rename resname PVP1 select segid DNPO .and. resid @cnt1:@cnt2 end
endif
if npvp2bot .gt. 0 then
   calc cnt1 = @cnt2 + 1
   calc cnt2 = @cnt1 + @npvp2bot - 1
   rename resname PVP2 select segid DNPO .and. resid @cnt1:@cnt2 end
endif
if npvp3bot .gt. 0 then
   calc cnt1 = @cnt2 + 1
   calc cnt2 = @cnt1 + @npvp3bot - 1
   rename resname PVP3 select segid DNPO .and. resid @cnt1:@cnt2 end
endif
if npvpibot .gt. 0 then
   calc cnt1 = @cnt2 + 1
   calc cnt2 = @cnt1 + @npvpibot - 1
   rename resname PVPI select segid DNPO .and. resid @cnt1:@cnt2 end
endif
if ncdl0bot .gt. 0 then
   calc cnt1 = @cnt2 + 1
   calc cnt2 = @cnt1 + @ncdl0bot - 1
   rename resname CDL0 select segid DNPO .and. resid @cnt1:@cnt2 end
   scalar type set @ipol2 sele segid DNPO .and. resid @cnt1:@cnt2 end
endif
if ncdl1bot .gt. 0 then
   calc cnt1 = @cnt2 + 1
   calc cnt2 = @cnt1 + @ncdl1bot - 1
   rename resname CDL1 select segid DNPO .and. resid @cnt1:@cnt2 end
   scalar type set @ipol2 sele segid DNPO .and. resid @cnt1:@cnt2 end
endif
if ncdl2bot .gt. 0 then
   calc cnt1 = @cnt2 + 1
   calc cnt2 = @cnt1 + @ncdl2bot - 1
   rename resname CDL2 select segid DNPO .and. resid @cnt1:@cnt2 end
   scalar type set @ipol2 sele segid DNPO .and. resid @cnt1:@cnt2 end
endif
if nbnsmbot .gt. 0 then
   calc cnt1 = @cnt2 + 1
   calc cnt2 = @cnt1 + @nbnsmbot - 1
   rename resname BNSM select segid DNPO .and. resid @cnt1:@cnt2 end
endif
if ndbsmbot .gt. 0 then
   calc cnt1 = @cnt2 + 1
   calc cnt2 = @cnt1 + @ndbsmbot - 1
   rename resname DBSM select segid DNPO .and. resid @cnt1:@cnt2 end
endif
if ndpsmbot .gt. 0 then
   calc cnt1 = @cnt2 + 1
   calc cnt2 = @cnt1 + @ndpsmbot - 1
   rename resname DPSM select segid DNPO .and. resid @cnt1:@cnt2 end
endif
if ndxsmbot .gt. 0 then
   calc cnt1 = @cnt2 + 1
   calc cnt2 = @cnt1 + @ndxsmbot - 1
   rename resname DXSM select segid DNPO .and. resid @cnt1:@cnt2 end
endif
if npgsmbot .gt. 0 then
   calc cnt1 = @cnt2 + 1
   calc cnt2 = @cnt1 + @npgsmbot - 1
   rename resname PGSM select segid DNPO .and. resid @cnt1:@cnt2 end
endif
if npnsmbot .gt. 0 then
   calc cnt1 = @cnt2 + 1
   calc cnt2 = @cnt1 + @npnsmbot - 1
   rename resname PNSM select segid DNPO .and. resid @cnt1:@cnt2 end
endif
if nposmbot .gt. 0 then
   calc cnt1 = @cnt2 + 1
   calc cnt2 = @cnt1 + @nposmbot - 1
   rename resname POSM select segid DNPO .and. resid @cnt1:@cnt2 end
endif
if npvsmbot .gt. 0 then
   calc cnt1 = @cnt2 + 1
   calc cnt2 = @cnt1 + @npvsmbot - 1
   rename resname PVSM select segid DNPO .and. resid @cnt1:@cnt2 end
endif
if nxnsmbot .gt. 0 then
   calc cnt1 = @cnt2 + 1
   calc cnt2 = @cnt1 + @nxnsmbot - 1
   rename resname XNSM select segid DNPO .and. resid @cnt1:@cnt2 end
endif
if ndpcebot .gt. 0 then
   calc cnt1 = @cnt2 + 1
   calc cnt2 = @cnt1 + @ndpcebot - 1
   rename resname DPCE select segid DNPO .and. resid @cnt1:@cnt2 end
endif
if ndxcebot .gt. 0 then
   calc cnt1 = @cnt2 + 1
   calc cnt2 = @cnt1 + @ndxcebot - 1
   rename resname DXCE select segid DNPO .and. resid @cnt1:@cnt2 end
endif
if npncebot .gt. 0 then
   calc cnt1 = @cnt2 + 1
   calc cnt2 = @cnt1 + @npncebot - 1
   rename resname PNCE select segid DNPO .and. resid @cnt1:@cnt2 end
endif
if nxncebot .gt. 0 then
   calc cnt1 = @cnt2 + 1
   calc cnt2 = @cnt1 + @nxncebot - 1
   rename resname XNCE select segid DNPO .and. resid @cnt1:@cnt2 end
endif
if npadgbot .gt. 0 then
   calc cnt1 = @cnt2 + 1
   calc cnt2 = @cnt1 + @npadgbot - 1
   rename resname PADG select segid DNPO .and. resid @cnt1:@cnt2 end
endif
if npidgbot .gt. 0 then
   calc cnt1 = @cnt2 + 1
   calc cnt2 = @cnt1 + @npidgbot - 1
   rename resname PIDG select segid DNPO .and. resid @cnt1:@cnt2 end
endif
if npodgbot .gt. 0 then
   calc cnt1 = @cnt2 + 1
   calc cnt2 = @cnt1 + @npodgbot - 1
   rename resname PODG select segid DNPO .and. resid @cnt1:@cnt2 end
endif
if npudgbot .gt. 0 then
   calc cnt1 = @cnt2 + 1
   calc cnt2 = @cnt1 + @npudgbot - 1
   rename resname PUDG select segid DNPO .and. resid @cnt1:@cnt2 end
endif
if npvdgbot .gt. 0 then
   calc cnt1 = @cnt2 + 1
   calc cnt2 = @cnt1 + @npvdgbot - 1
   rename resname PVDG select segid DNPO .and. resid @cnt1:@cnt2 end
endif
if ntogbot .gt. 0 then
   calc cnt1 = @cnt2 + 1
   calc cnt2 = @cnt1 + @ntogbot - 1
   rename resname TOG select segid DNPO .and. resid @cnt1:@cnt2 end
endif
if napcbot .gt. 0 then
   calc cnt1 = @cnt2 + 1
   calc cnt2 = @cnt1 + @napcbot - 1
   rename resname APC select segid DNPO .and. resid @cnt1:@cnt2 end
endif
if ncpcbot .gt. 0 then
   calc cnt1 = @cnt2 + 1
   calc cnt2 = @cnt1 + @ncpcbot - 1
   rename resname CPC select segid DNPO .and. resid @cnt1:@cnt2 end
endif
if nipcbot .gt. 0 then
   calc cnt1 = @cnt2 + 1
   calc cnt2 = @cnt1 + @nipcbot - 1
   rename resname IPC select segid DNPO .and. resid @cnt1:@cnt2 end
endif
if nlpcbot .gt. 0 then
   calc cnt1 = @cnt2 + 1
   calc cnt2 = @cnt1 + @nlpcbot - 1
   rename resname LPC select segid DNPO .and. resid @cnt1:@cnt2 end
endif
if nopcbot .gt. 0 then
   calc cnt1 = @cnt2 + 1
   calc cnt2 = @cnt1 + @nopcbot - 1
   rename resname OPC select segid DNPO .and. resid @cnt1:@cnt2 end
endif
if nppcbot .gt. 0 then
   calc cnt1 = @cnt2 + 1
   calc cnt2 = @cnt1 + @nppcbot - 1
   rename resname PPC select segid DNPO .and. resid @cnt1:@cnt2 end
endif
if ntpcbot .gt. 0 then
   calc cnt1 = @cnt2 + 1
   calc cnt2 = @cnt1 + @ntpcbot - 1
   rename resname TPC select segid DNPO .and. resid @cnt1:@cnt2 end
endif
if nupcbot .gt. 0 then
   calc cnt1 = @cnt2 + 1
   calc cnt2 = @cnt1 + @nupcbot - 1
   rename resname UPC select segid DNPO .and. resid @cnt1:@cnt2 end
endif
if nvpcbot .gt. 0 then
   calc cnt1 = @cnt2 + 1
   calc cnt2 = @cnt1 + @nvpcbot - 1
   rename resname VPC select segid DNPO .and. resid @cnt1:@cnt2 end
endif
if nacabot .gt. 0 then
   calc cnt1 = @cnt2 + 1
   calc cnt2 = @cnt1 + @nacabot - 1
   rename resname ACA select segid DNPO .and. resid @cnt1:@cnt2 end
   scalar type set @ipolf sele segid DNPO .and. resid @cnt1:@cnt2 end
endif
if nacnbot .gt. 0 then
   calc cnt1 = @cnt2 + 1
   calc cnt2 = @cnt1 + @nacnbot - 1
   rename resname ACN select segid DNPO .and. resid @cnt1:@cnt2 end
   scalar type set @ipolf sele segid DNPO .and. resid @cnt1:@cnt2 end
endif
if nbcabot .gt. 0 then
   calc cnt1 = @cnt2 + 1
   calc cnt2 = @cnt1 + @nbcabot - 1
   rename resname BCA select segid DNPO .and. resid @cnt1:@cnt2 end
   scalar type set @ipolf sele segid DNPO .and. resid @cnt1:@cnt2 end
endif
if nbcnbot .gt. 0 then
   calc cnt1 = @cnt2 + 1
   calc cnt2 = @cnt1 + @nbcnbot - 1
   rename resname BCN select segid DNPO .and. resid @cnt1:@cnt2 end
   scalar type set @ipolf sele segid DNPO .and. resid @cnt1:@cnt2 end
endif
if nlcabot .gt. 0 then
   calc cnt1 = @cnt2 + 1
   calc cnt2 = @cnt1 + @nlcabot - 1
   rename resname LCA select segid DNPO .and. resid @cnt1:@cnt2 end
   scalar type set @ipolf sele segid DNPO .and. resid @cnt1:@cnt2 end
endif
if nlcnbot .gt. 0 then
   calc cnt1 = @cnt2 + 1
   calc cnt2 = @cnt1 + @nlcnbot - 1
   rename resname LCN select segid DNPO .and. resid @cnt1:@cnt2 end
   scalar type set @ipolf sele segid DNPO .and. resid @cnt1:@cnt2 end
endif
if npcnbot .gt. 0 then
   calc cnt1 = @cnt2 + 1
   calc cnt2 = @cnt1 + @npcnbot - 1
   rename resname PCN select segid DNPO .and. resid @cnt1:@cnt2 end
   scalar type set @ipolf sele segid DNPO .and. resid @cnt1:@cnt2 end
endif
if nucabot .gt. 0 then
   calc cnt1 = @cnt2 + 1
   calc cnt2 = @cnt1 + @nucabot - 1
   rename resname UCA select segid DNPO .and. resid @cnt1:@cnt2 end
   scalar type set @ipolf sele segid DNPO .and. resid @cnt1:@cnt2 end
endif
if nucnbot .gt. 0 then
   calc cnt1 = @cnt2 + 1
   calc cnt2 = @cnt1 + @nucnbot - 1
   rename resname UCN select segid DNPO .and. resid @cnt1:@cnt2 end
   scalar type set @ipolf sele segid DNPO .and. resid @cnt1:@cnt2 end
endif
if nxcabot .gt. 0 then
   calc cnt1 = @cnt2 + 1
   calc cnt2 = @cnt1 + @nxcabot - 1
   rename resname XCA select segid DNPO .and. resid @cnt1:@cnt2 end
   scalar type set @ipolf sele segid DNPO .and. resid @cnt1:@cnt2 end
endif
if nxcnbot .gt. 0 then
   calc cnt1 = @cnt2 + 1
   calc cnt2 = @cnt1 + @nxcnbot - 1
   rename resname XCN select segid DNPO .and. resid @cnt1:@cnt2 end
   scalar type set @ipolf sele segid DNPO .and. resid @cnt1:@cnt2 end
endif
if npcabot .gt. 0 then
   calc cnt1 = @cnt2 + 1
   calc cnt2 = @cnt1 + @npcabot - 1
   rename resname PCA select segid DNPO .and. resid @cnt1:@cnt2 end
   scalar type set @ipolf sele segid DNPO .and. resid @cnt1:@cnt2 end
endif
if nbogbot .gt. 0 then
   calc cnt1 = @cnt2 + 1
   calc cnt2 = @cnt1 + @nbogbot - 1
   rename resname BOG select segid DNPO .and. resid @cnt1:@cnt2 end
endif
if nddmbot .gt. 0 then
   calc cnt1 = @cnt2 + 1
   calc cnt2 = @cnt1 + @nddmbot - 1
   rename resname DDM select segid DNPO .and. resid @cnt1:@cnt2 end
endif
if ndpcbot .gt. 0 then
   calc cnt1 = @cnt2 + 1
   calc cnt2 = @cnt1 + @ndpcbot - 1
   rename resname DPC select segid DNPO .and. resid @cnt1:@cnt2 end
endif
if neo5bot .gt. 0 then
   calc cnt1 = @cnt2 + 1
   calc cnt2 = @cnt1 + @neo5bot - 1
   rename resname EO5 select segid DNPO .and. resid @cnt1:@cnt2 end
endif
if nsdsbot .gt. 0 then
   calc cnt1 = @cnt2 + 1
   calc cnt2 = @cnt1 + @nsdsbot - 1
   rename resname SDS select segid DNPO .and. resid @cnt1:@cnt2 end
endif
if ndbg1bot .gt. 0 then
   calc cnt1 = @cnt2 + 1
   calc cnt2 = @cnt1 + @ndbg1bot - 1
   rename resname DBG1 select segid DNPO .and. resid @cnt1:@cnt2 end
endif
if ndbg3bot .gt. 0 then
   calc cnt1 = @cnt2 + 1
   calc cnt2 = @cnt1 + @ndbg3bot - 1
   rename resname DBG3 select segid DNPO .and. resid @cnt1:@cnt2 end
endif
if ndfggbot .gt. 0 then
   calc cnt1 = @cnt2 + 1
   calc cnt2 = @cnt1 + @ndfggbot - 1
   rename resname DFGG select segid DNPO .and. resid @cnt1:@cnt2 end
endif
if ndfmgbot .gt. 0 then
   calc cnt1 = @cnt2 + 1
   calc cnt2 = @cnt1 + @ndfmgbot - 1
   rename resname DFMG select segid DNPO .and. resid @cnt1:@cnt2 end
endif
if ndpg1bot .gt. 0 then
   calc cnt1 = @cnt2 + 1
   calc cnt2 = @cnt1 + @ndpg1bot - 1
   rename resname DPG1 select segid DNPO .and. resid @cnt1:@cnt2 end
endif
if ndpg3bot .gt. 0 then
   calc cnt1 = @cnt2 + 1
   calc cnt2 = @cnt1 + @ndpg3bot - 1
   rename resname DPG3 select segid DNPO .and. resid @cnt1:@cnt2 end
endif
if ndpggbot .gt. 0 then
   calc cnt1 = @cnt2 + 1
   calc cnt2 = @cnt1 + @ndpggbot - 1
   rename resname DPGG select segid DNPO .and. resid @cnt1:@cnt2 end
endif
if ndpgsbot .gt. 0 then
   calc cnt1 = @cnt2 + 1
   calc cnt2 = @cnt1 + @ndpgsbot - 1
   rename resname DPGS select segid DNPO .and. resid @cnt1:@cnt2 end
endif
if ndpmgbot .gt. 0 then
   calc cnt1 = @cnt2 + 1
   calc cnt2 = @cnt1 + @ndpmgbot - 1
   rename resname DPMG select segid DNPO .and. resid @cnt1:@cnt2 end
endif
if ndpsgbot .gt. 0 then
   calc cnt1 = @cnt2 + 1
   calc cnt2 = @cnt1 + @ndpsgbot - 1
   rename resname DPSG select segid DNPO .and. resid @cnt1:@cnt2 end
endif
if ndxg1bot .gt. 0 then
   calc cnt1 = @cnt2 + 1
   calc cnt2 = @cnt1 + @ndxg1bot - 1
   rename resname DXG1 select segid DNPO .and. resid @cnt1:@cnt2 end
endif
if ndxg3bot .gt. 0 then
   calc cnt1 = @cnt2 + 1
   calc cnt2 = @cnt1 + @ndxg3bot - 1
   rename resname DXG3 select segid DNPO .and. resid @cnt1:@cnt2 end
endif
if nfpggbot .gt. 0 then
   calc cnt1 = @cnt2 + 1
   calc cnt2 = @cnt1 + @nfpggbot - 1
   rename resname FPGG select segid DNPO .and. resid @cnt1:@cnt2 end
endif
if nfpmgbot .gt. 0 then
   calc cnt1 = @cnt2 + 1
   calc cnt2 = @cnt1 + @nfpmgbot - 1
   rename resname FPMG select segid DNPO .and. resid @cnt1:@cnt2 end
endif
if nfpsgbot .gt. 0 then
   calc cnt1 = @cnt2 + 1
   calc cnt2 = @cnt1 + @nfpsgbot - 1
   rename resname FPSG select segid DNPO .and. resid @cnt1:@cnt2 end
endif
if nopggbot .gt. 0 then
   calc cnt1 = @cnt2 + 1
   calc cnt2 = @cnt1 + @nopggbot - 1
   rename resname OPGG select segid DNPO .and. resid @cnt1:@cnt2 end
endif
if nopmgbot .gt. 0 then
   calc cnt1 = @cnt2 + 1
   calc cnt2 = @cnt1 + @nopmgbot - 1
   rename resname OPMG select segid DNPO .and. resid @cnt1:@cnt2 end
endif
if nopsgbot .gt. 0 then
   calc cnt1 = @cnt2 + 1
   calc cnt2 = @cnt1 + @nopsgbot - 1
   rename resname OPSG select segid DNPO .and. resid @cnt1:@cnt2 end
endif
if npng1bot .gt. 0 then
   calc cnt1 = @cnt2 + 1
   calc cnt2 = @cnt1 + @npng1bot - 1
   rename resname PNG1 select segid DNPO .and. resid @cnt1:@cnt2 end
endif
if npng3bot .gt. 0 then
   calc cnt1 = @cnt2 + 1
   calc cnt2 = @cnt1 + @npng3bot - 1
   rename resname PNG3 select segid DNPO .and. resid @cnt1:@cnt2 end
endif
if nxng1bot .gt. 0 then
   calc cnt1 = @cnt2 + 1
   calc cnt2 = @cnt1 + @nxng1bot - 1
   rename resname XNG1 select segid DNPO .and. resid @cnt1:@cnt2 end
endif
if nxng3bot .gt. 0 then
   calc cnt1 = @cnt2 + 1
   calc cnt2 = @cnt1 + @nxng3bot - 1
   rename resname XNG3 select segid DNPO .and. resid @cnt1:@cnt2 end
endif
if nrampbot .gt. 0 then
   calc cnt1 = @cnt2 + 1
   calc cnt2 = @cnt1 + @nrampbot - 1
   rename resname RAMP select segid DNPO .and. resid @cnt1:@cnt2 end
   scalar type set @ipol4 sele segid DNPO .and. resid @cnt1:@cnt2 end
   calc nlpsbot = @nlpsbot + @nrampbot
endif
if nrempbot .gt. 0 then
   calc cnt1 = @cnt2 + 1
   calc cnt2 = @cnt1 + @nrempbot - 1
   rename resname REMP select segid DNPO .and. resid @cnt1:@cnt2 end
   scalar type set @ipol4 sele segid DNPO .and. resid @cnt1:@cnt2 end
   calc nlpsbot = @nlpsbot + @nrempbot
endif
if noantbot .gt. 0 then
   calc cnt1 = @cnt2 + 1
   calc cnt2 = @cnt1 + @noantbot - 1
   rename resname OANT select segid DNPO .and. resid @cnt1:@cnt2 end
   scalar type set @ipol4 sele segid DNPO .and. resid @cnt1:@cnt2 end
   calc nlpsbot = @nlpsbot + @noantbot
endif
if ndspcbot .gt. 0 then
   calc cnt1 = @cnt2 + 1
   calc cnt2 = @cnt1 + @ndspcbot - 1
   rename resname DSPC select segid DNPO .and. resid @cnt1:@cnt2 end
endif
if ndhpebot .gt. 0 then
   calc cnt1 = @cnt2 + 1
   calc cnt2 = @cnt1 + @ndhpebot - 1
   rename resname DHPE select segid DNPO .and. resid @cnt1:@cnt2 end
endif
if ndspebot .gt. 0 then
   calc cnt1 = @cnt2 + 1
   calc cnt2 = @cnt1 + @ndspebot - 1
   rename resname DSPE select segid DNPO .and. resid @cnt1:@cnt2 end
endif

! charged lipids
scalar charge set -1 sele resname choa end
scalar charge set -2 sele resname dapa end
scalar charge set -2 sele resname dbpa end
scalar charge set -2 sele resname dfpa end
scalar charge set -2 sele resname dgpa end
scalar charge set -2 sele resname dipa end
scalar charge set -2 sele resname dlpa end
scalar charge set -2 sele resname dnpa end
scalar charge set -2 sele resname dopa end
scalar charge set -2 sele resname dppa end
scalar charge set -2 sele resname drpa end
scalar charge set -2 sele resname dtpa end
scalar charge set -2 sele resname dvpa end
scalar charge set -2 sele resname dxpa end
scalar charge set -2 sele resname dypa end
scalar charge set -2 sele resname lppa end
scalar charge set -2 sele resname papa end
scalar charge set -2 sele resname pgpa end
scalar charge set -2 sele resname pipa end
scalar charge set -2 sele resname popa end
scalar charge set -2 sele resname prpa end
scalar charge set -2 sele resname pupa end
scalar charge set -1 sele resname dapg end
scalar charge set -1 sele resname dbpg end
scalar charge set -1 sele resname dfpg end
scalar charge set -1 sele resname dgpg end
scalar charge set -1 sele resname dipg end
scalar charge set -1 sele resname dlpg end
scalar charge set -1 sele resname dnpg end
scalar charge set -1 sele resname dopg end
scalar charge set -1 sele resname dppg end
scalar charge set -1 sele resname drpg end
scalar charge set -1 sele resname dtpg end
scalar charge set -1 sele resname dvpg end
scalar charge set -1 sele resname dxpg end
scalar charge set -1 sele resname dypg end
scalar charge set -1 sele resname jfpg end
scalar charge set -1 sele resname jppg end
scalar charge set -1 sele resname lppg end
scalar charge set -1 sele resname oppg end
scalar charge set -1 sele resname papg end
scalar charge set -1 sele resname pgpg end
scalar charge set -1 sele resname pipg end
scalar charge set -1 sele resname popg end
scalar charge set -1 sele resname prpg end
scalar charge set -1 sele resname daps end
scalar charge set -1 sele resname dbps end
scalar charge set -1 sele resname dfps end
scalar charge set -1 sele resname dgps end
scalar charge set -1 sele resname dips end
scalar charge set -1 sele resname dlps end
scalar charge set -1 sele resname dnps end
scalar charge set -1 sele resname dops end
scalar charge set -1 sele resname dpps end
scalar charge set -1 sele resname drps end
scalar charge set -1 sele resname dtps end
scalar charge set -1 sele resname dups end
scalar charge set -1 sele resname dvps end
scalar charge set -1 sele resname dxps end
scalar charge set -1 sele resname dyps end
scalar charge set -1 sele resname lpps end
scalar charge set -1 sele resname paps end
scalar charge set -1 sele resname pgps end
scalar charge set -1 sele resname pips end
scalar charge set -1 sele resname pops end
scalar charge set -1 sele resname pqps end
scalar charge set -1 sele resname prps end
scalar charge set -1 sele resname pups end
scalar charge set -3 sele resname dpp1 end
scalar charge set -5 sele resname dpp2 end
scalar charge set -1 sele resname dppi end
scalar charge set -1 sele resname papi end
scalar charge set -1 sele resname pipi end
scalar charge set -3 sele resname pop1 end
scalar charge set -5 sele resname pop2 end
scalar charge set -7 sele resname pop3 end
scalar charge set -1 sele resname popi end
scalar charge set -1 sele resname pupi end
scalar charge set -3 sele resname pvp1 end
scalar charge set -5 sele resname pvp2 end
scalar charge set -7 sele resname pvp3 end
scalar charge set -1 sele resname pvpi end
scalar charge set -1 sele resname cdl1 end
scalar charge set -2 sele resname cdl2 end
scalar charge set -1 sele resname acn end
scalar charge set -1 sele resname bcn end
scalar charge set -1 sele resname lcn end
scalar charge set -1 sele resname pcn end
scalar charge set -1 sele resname ucn end
scalar charge set -1 sele resname xcn end
scalar charge set -1 sele resname sds end
scalar charge set -1 sele resname dbg1 end
scalar charge set -1 sele resname dbg3 end
scalar charge set -1 sele resname dpg1 end
scalar charge set -1 sele resname dpg3 end
scalar charge set -1 sele resname dpsg end
scalar charge set -1 sele resname dxg1 end
scalar charge set -1 sele resname dxg3 end
scalar charge set -1 sele resname fpsg end
scalar charge set -1 sele resname opsg end
scalar charge set -1 sele resname png1 end
scalar charge set -1 sele resname png3 end
scalar charge set -1 sele resname xng1 end
scalar charge set -1 sele resname xng3 end
scalar charge set -10 sele resname ramp end
scalar charge set -6 sele resname remp end
scalar charge set -10 sele resname oant end

! First, guess available regions for initial positions of the big-spheres (150%)
calc Ainit = @A * 1.5
calc Binit = @B * 1.5

! Define the boundary for non-accessible regions of the big-spheres
define uppo sele ( .not. ( segid UPPO .or. segid DNPO ) ) .and. ( prop Z .gt.  10 ) .and. (prop Z .lt.  20 ) end
if ?nsel .gt. 0 then
   coor stat sele uppo end
   calc xpup = ?xmax
   calc xnup = ?xmin
   calc ypup = ?ymax
   calc ynup = ?ymin
else
   calc xpup = 0
   calc xnup = 0
   calc ypup = 0
   calc ynup = 0
endif

define dnpo sele ( .not. ( segid UPPO .or. segid DNPO ) ) .and. ( prop Z .gt. -20 ) .and. (prop Z .lt. -10 ) end
if ?nsel .gt. 0 then
   coor stat sele dnpo end
   calc xpdn = ?xmax
   calc xndn = ?xmin
   calc ypdn = ?ymax
   calc yndn = ?ymin
else
   calc xpdn = 0
   calc xndn = 0
   calc ypdn = 0
   calc yndn = 0
endif

! to prevent infinite-loop
calc A2 = @A/2
calc B2 = @A/2
if xpup .gt.  @A2 stop
if xnup .lt. -@A2 stop
if ypup .gt.  @B2 stop
if ynup .lt. -@B2 stop
if xpdn .gt.  @A2 stop
if xndn .lt. -@A2 stop
if ypdn .gt.  @B2 stop
if yndn .lt. -@B2 stop

!----------------------------------------------------------------------
! Put big-spheres molecules at random positions

! Random number generation
RAND UNIF ISEED 1542785572 SCALE 1.0

calc i = 1

label do_up

  label rand_up
  calc xpos = ?random
  calc ypos = ?random
  calc xpos = @Ainit * ( @xpos - 0.5 )
  calc ypos = @Binit * ( @ypos - 0.5 )

  set iprot = 1
  label check_prot_up
     define XXX sele uppo .and. iseg @iprot end
     if ?nsel .gt. 0 then
        coor stat sele XXX end
        calc xpup = ?xmax + 5
        calc xnup = ?xmin - 5
        calc ypup = ?ymax + 5
        calc ynup = ?ymin - 5
     else
        calc xpup = 0
        calc xnup = 0
        calc ypup = 0
        calc ynup = 0
     endif
     if xpos .gt. @xnup if xpos .lt. @xpup if ypos .gt. @ynup if ypos .lt. @ypup goto rand_up
     incr iprot by 1
  if iprot .le. @nprot goto check_prot_up

  calc zpos = 12.0 

  coor set xdir @xpos  ydir @ypos  zdir @zpos select segid UPPO .and. resid @i end

  MMFP
  GEO plane  RCM -
      xref 0.0  yref 0.0  zref  @zpos  zdir 1.0 -
      force  100.0   select segid UPPO .and. resi @i end
  END

incr i by 1
if i le @NLIPTOP goto do_up


calc i = 1

label do_dn

  label rand_dn
  calc xpos = ?random
  calc ypos = ?random
  calc xpos = @Ainit * ( @xpos - 0.5 )
  calc ypos = @Binit * ( @ypos - 0.5 )

  set iprot = 1
  label check_prot_dn
     define XXX sele dnpo .and. iseg @iprot end
     if ?nsel .gt. 0 then
        coor stat sele XXX end
        calc xpdn = ?xmax + 5
        calc xndn = ?xmin - 5
        calc ypdn = ?ymax + 5
        calc yndn = ?ymin - 5
     else
        calc xpdn = 0
        calc xndn = 0
        calc ypdn = 0
        calc yndn = 0
     endif
     if xpos .gt. @xndn if xpos .lt. @xpdn if ypos .gt. @yndn if ypos .lt. @ypdn goto rand_dn
     incr iprot by 1
  if iprot .le. @nprot goto check_prot_dn

  calc zpos = -12.0 

  coor set xdir @xpos  ydir @ypos  zdir @zpos select segid DNPO .and. resid @i end

  MMFP
  GEO plane  RCM -
      xref 0.0  yref 0.0  zref  @zpos  zdir 1.0 -
      force  100.0   select segid DNPO .and. resi @i end
  END

incr i by 1
if i le @NLIPBOT goto do_dn

rename SEGid HEAD sele segid UPPO end
join HEAD DNPO renumber

!------------------------------------------------------------------------------
! Build the Periodic Boundary Conditions and
! Carry out Minimization and Dynamics for Equilibration of Large Spheres
! 6 cycles to reduce the Ainit and Binit back to original A and B

cons fix sele .not. segid HEAD end

! LD simulation steps depend on the number of lipid spheres
calc nstep = int ( ( @NLIPTOP + @NLIPBOT ) * 4 / 1000 + 1 ) * 1000

set i = 5

label do_packing

calc Ainit = @A * 1.@i
calc Binit = @B * 1.@i

if i .ne. 5 crystal free
crystal define @xtltype @Ainit @Binit 10000.0 @Alpha @beta @Gamma

open read unit 10 card name crystal_image.str
crystal read unit 10 card
close unit 10

image byresid xcen 0.0 ycen 0.0 zcen 0.0 sele segid HEAD end

!setup nonbond option (eps=80)
nbonds atom switch cdie vdw vfswitch  -
       ctonnb 20.0 ctofnb 22.0 cutnb 26.0 cutim 26.0 -
       inbfrq -1 imgfrq -1 wmin 1.0 cdie eps 80.0

ENERGY

mini sd   nstep 200    nprint 10
mini abnr nstep 200    nprint 10

scalar fbeta set  1.0 select all end

DYNAMICS  start       nstep   @nstep  timestp  0.001 iprfrq   1000  nprint 100  -
          iasvel    1 firstt 300.0  finalt   300.0 tstruc  300.0  -
          langevin    tbath  300.0  rbuf       0.0 -
          inbfrq   -1 imgfrq    -1  ihbfrq       0 ilbfrq      0  -
          iunread  -1  -
          iunwrite -1  -
          iuncrd   -1 nsavcrd    0  -
          iunvelo  -1 nsavvelo   0  -
          kunit    -1  

decrease i by 1
if i .ge. 0 goto do_packing

updat cutim 35.0 imall

open write card unit 1 name step3_packing.pdb
write coor pdb  unit 1 image
close unit 1

!
! HEAD ONLY
!

crystal free
define junk sele .not. segid HEAD end
if ?nsel .ne. 0 delete atom sele junk end

open write card unit 10 name step3_packing_head.crd
write coor card unit 10 

open write card unit 10 name step3_packing_head.pdb
write coor pdb  unit 10 

open write unit 10 card name step3_packing_head.psf
write psf  unit 10 card

stop